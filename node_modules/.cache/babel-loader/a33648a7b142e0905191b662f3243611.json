{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Acer\\\\Desktop\\\\Work\\\\garaaz-distributor\\\\src\\\\components\\\\WorkShopList\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Button, Box, Menu, MenuButton, MenuList, MenuItem, Center } from '@chakra-ui/react';\nimport { useSelector, useDispatch } from 'react-redux';\n/* import { getWorkshops } from './actions'; */\n\nimport messages from './messages';\nimport serverErrorIllustrator from \"../../assets/img/serverError.svg\";\nimport Error from '../Error';\nimport { useIntl } from 'react-intl';\nimport './style.css';\nimport { optionsProp } from './constants';\nimport AdditionOption from '../../utils/AdditionOptions';\nimport { Loading } from '../Loading';\nimport { selectGlobalState, getWorkshops } from '../../globalSlice';\nimport { Link } from 'react-router-dom';\nimport DynamicTable from '../DynamicTable';\nimport { FiMoreVertical } from 'react-icons/fi';\nimport { useHistory } from 'react-router';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst WorkshopList = _ref => {\n  _s();\n\n  let {\n    notification\n  } = _ref;\n  const [serverError, setServerError] = useState(false);\n  const intl = useIntl();\n  const auth = useSelector(state => state.auth);\n  const [openBulk, setOpenBulk] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [totalCount, setTotalCount] = useState(0);\n  const [isLoading, setIsLoading] = useState(false);\n  const [pageCount, setPageCount] = useState(0);\n  const {\n    workshops,\n    distributor,\n    isDistributor\n  } = useSelector(selectGlobalState);\n  const dispatcher = useDispatch();\n  const history = useHistory();\n  useEffect(() => {\n    setPageCount(Math.ceil(workshops.totalCount.count / 10));\n  }, [workshops]);\n\n  const fetchAllParts = params => {\n    (async () => {\n      setIsLoading(true);\n\n      try {\n        const response = await dispatcher(getWorkshops({\n          auth,\n          params,\n          distributorId: distributor._id\n        }));\n        params.limit = (params === null || params === void 0 ? void 0 : params.limit) ? params === null || params === void 0 ? void 0 : params.limit : 10;\n        console.log('XXX', response.data.totalCount.count);\n        setPageCount(Math.ceil(response.data.totalCount.count / (params === null || params === void 0 ? void 0 : params.limit)));\n        setTotalCount(response.totalCount.count);\n        setIsLoading(false);\n      } catch (error) {\n        setIsLoading(false);\n\n        if (error.response) {\n          var _error$response$data$;\n\n          notification({\n            status: 'error',\n            description: (_error$response$data$ = error.response.data.message) !== null && _error$response$data$ !== void 0 ? _error$response$data$ : intl.formatMessage(messages.errorMessage)\n          });\n        }\n      }\n    })();\n  };\n\n  const columns = React.useMemo(() => [{\n    Header: 'S. No',\n    accessor: 'sno',\n    Cell: allData => {\n      var _allData$row;\n\n      return /*#__PURE__*/_jsxDEV(Box, {\n        children: (allData === null || allData === void 0 ? void 0 : (_allData$row = allData.row) === null || _allData$row === void 0 ? void 0 : _allData$row.index) + 1\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 18\n      }, this);\n    }\n  }, {\n    Header: 'Workshop Code',\n    accessor: 'code'\n  }, {\n    Header: 'Workshop Name',\n    accessor: 'name'\n  }, {\n    Header: 'Workshop Type',\n    accessor: 'type'\n  }, {\n    Header: 'Branch Code',\n    accessor: row => {\n      var _row$branch;\n\n      return (_row$branch = row.branch) === null || _row$branch === void 0 ? void 0 : _row$branch.branchCode;\n    }\n  }, {\n    Header: 'Owner Name',\n    accessor: 'ownerFullName'\n  }, {\n    Header: 'Mobile Number',\n    accessor: 'mobileNumber'\n  }, {\n    Header: 'Credit Days',\n    accessor: 'creditDays'\n  }, {\n    Header: 'Discount',\n    accessor: 'discount'\n  }, {\n    Header: 'Action',\n    accessor: '_id',\n    Cell: _ref2 => {\n      let {\n        value\n      } = _ref2;\n      return /*#__PURE__*/_jsxDEV(Menu, {\n        children: [/*#__PURE__*/_jsxDEV(MenuButton, {\n          p: 0,\n          as: Button,\n          children: /*#__PURE__*/_jsxDEV(Center, {\n            children: /*#__PURE__*/_jsxDEV(FiMoreVertical, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 122,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(MenuList, {\n          onClick: () => {\n            history.push(`/workshop/${value}/edit`);\n          },\n          children: /*#__PURE__*/_jsxDEV(MenuItem, {\n            children: \"View Detail\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 13\n      }, this);\n    }\n  }], []);\n  const employeeColumn = React.useMemo(() => [{\n    Header: 'S. No',\n    accessor: 'sno',\n    Cell: allData => {\n      var _allData$row2;\n\n      return /*#__PURE__*/_jsxDEV(Box, {\n        children: (allData === null || allData === void 0 ? void 0 : (_allData$row2 = allData.row) === null || _allData$row2 === void 0 ? void 0 : _allData$row2.index) + 1\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 18\n      }, this);\n    }\n  }, {\n    Header: 'Workshop Code',\n    accessor: 'code'\n  }, {\n    Header: 'Workshop Name',\n    accessor: 'name'\n  }, {\n    Header: 'Workshop Type',\n    accessor: 'type'\n  }, {\n    Header: 'Branch Code',\n    accessor: row => {\n      var _row$branch2;\n\n      return (_row$branch2 = row.branch) === null || _row$branch2 === void 0 ? void 0 : _row$branch2.branchCode;\n    }\n  }, {\n    Header: 'Owner Name',\n    accessor: 'ownerFullName'\n  }, {\n    Header: 'Mobile Number',\n    accessor: 'mobileNumber'\n  }, {\n    Header: 'Credit Days',\n    accessor: 'creditDays'\n  }, {\n    Header: 'Discount',\n    accessor: 'discount'\n  }], []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-0 p-1 pb-0 \",\n      children: [workshops.data.length > 0 && isDistributor && /*#__PURE__*/_jsxDEV(Box, {\n        textAlign: \"right\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/workshop/add\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"normal\",\n            size: \"md\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-user-plus mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 17\n            }, this), intl.formatMessage(messages.addWorkshop)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 11\n      }, this), !navigator.onLine ? /*#__PURE__*/_jsxDEV(Error, {\n        onRetry: () => {\n          dispatcher(getWorkshops({\n            auth,\n            distributorId: distributor._id,\n            params: {\n              limit: 10,\n              offset: 0\n            }\n          }));\n          setTotalCount(0);\n          setPageCount(0);\n        },\n        title: intl.formatMessage(messages.networkErrorTitle),\n        message: intl.formatMessage(messages.networkErrorMessage),\n        illustrator: serverErrorIllustrator\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 11\n      }, this) : serverError ? /*#__PURE__*/_jsxDEV(Error, {\n        onRetry: () => getWorkshops({\n          auth,\n          distributorId: distributor._id\n        }),\n        title: intl.formatMessage(messages.serverErrorTitle),\n        message: intl.formatMessage(messages.serverErrorMessage),\n        illustrator: serverErrorIllustrator\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 11\n      }, this) : loading ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 11\n      }, this) : workshops.data.length > 0 ?\n      /*#__PURE__*/\n\n      /*  <WorkshopTable workshops={workshops} isOpen={openBulk} /> */\n      _jsxDEV(Box, {\n        mt: 6,\n        children: /*#__PURE__*/_jsxDEV(DynamicTable, {\n          columns: isDistributor ? columns : employeeColumn,\n          data: workshops.data,\n          fetchData: fetchAllParts,\n          totalCount: totalCount,\n          controlledPageCount: pageCount,\n          loading: isLoading,\n          skipPageReset: true,\n          params: {}\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(AdditionOption, { ...optionsProp\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 186,\n    columnNumber: 5\n  }, this);\n};\n\n_s(WorkshopList, \"Whcy1BMaNQzaZg7HFEJ9ifadUps=\", false, function () {\n  return [useIntl, useSelector, useSelector, useDispatch, useHistory];\n});\n\n_c = WorkshopList;\nexport default WorkshopList;\n\nvar _c;\n\n$RefreshReg$(_c, \"WorkshopList\");","map":{"version":3,"sources":["C:/Users/Acer/Desktop/Work/garaaz-distributor/src/components/WorkShopList/index.js"],"names":["React","useEffect","useState","Button","Box","Menu","MenuButton","MenuList","MenuItem","Center","useSelector","useDispatch","messages","Error","useIntl","optionsProp","AdditionOption","Loading","selectGlobalState","getWorkshops","Link","DynamicTable","FiMoreVertical","useHistory","WorkshopList","notification","serverError","setServerError","intl","auth","state","openBulk","setOpenBulk","loading","setLoading","totalCount","setTotalCount","isLoading","setIsLoading","pageCount","setPageCount","workshops","distributor","isDistributor","dispatcher","history","Math","ceil","count","fetchAllParts","params","response","distributorId","_id","limit","console","log","data","error","status","description","message","formatMessage","errorMessage","columns","useMemo","Header","accessor","Cell","allData","row","index","branch","branchCode","value","push","employeeColumn","length","addWorkshop","navigator","onLine","offset","networkErrorTitle","networkErrorMessage","serverErrorIllustrator","serverErrorTitle","serverErrorMessage"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,MAAT,EAAiBC,GAAjB,EAAsBC,IAAtB,EACEC,UADF,EAEEC,QAFF,EAGEC,QAHF,EAIEC,MAJF,QAKQ,kBALR;AAMA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA;;AACA,OAAOC,QAAP,MAAqB,YAArB;;AAEA,OAAOC,KAAP,MAAkB,UAAlB;AACA,SAASC,OAAT,QAAwB,YAAxB;AACA,OAAO,aAAP;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,OAAOC,cAAP,MAA2B,6BAA3B;AACA,SAASC,OAAT,QAAwB,YAAxB;AACA,SAASC,iBAAT,EAA4BC,YAA5B,QAAgD,mBAAhD;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,OAAOC,YAAP,MAAyB,iBAAzB;AACA,SAASC,cAAT,QAA+B,gBAA/B;AACA,SAASC,UAAT,QAA2B,cAA3B;;;AAEA,MAAMC,YAAY,GAAG,QAAsB;AAAA;;AAAA,MAArB;AAAEC,IAAAA;AAAF,GAAqB;AACzC,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCzB,QAAQ,CAAC,KAAD,CAA9C;AACA,QAAM0B,IAAI,GAAGd,OAAO,EAApB;AACA,QAAMe,IAAI,GAAGnB,WAAW,CAAEoB,KAAD,IAAWA,KAAK,CAACD,IAAlB,CAAxB;AACA,QAAM,CAACE,QAAD,EAAWC,WAAX,IAA0B9B,QAAQ,CAAC,KAAD,CAAxC;AACA,QAAM,CAAC+B,OAAD,EAAUC,UAAV,IAAwBhC,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAACiC,UAAD,EAAaC,aAAb,IAA8BlC,QAAQ,CAAC,CAAD,CAA5C;AACA,QAAM,CAACmC,SAAD,EAAYC,YAAZ,IAA4BpC,QAAQ,CAAC,KAAD,CAA1C;AACA,QAAM,CAACqC,SAAD,EAAYC,YAAZ,IAA4BtC,QAAQ,CAAC,CAAD,CAA1C;AACA,QAAM;AAAEuC,IAAAA,SAAF;AAAaC,IAAAA,WAAb;AAA0BC,IAAAA;AAA1B,MACJjC,WAAW,CAACQ,iBAAD,CADb;AAEA,QAAM0B,UAAU,GAAGjC,WAAW,EAA9B;AACA,QAAMkC,OAAO,GAAGtB,UAAU,EAA1B;AAGAtB,EAAAA,SAAS,CAAC,MAAM;AACduC,IAAAA,YAAY,CAACM,IAAI,CAACC,IAAL,CAAUN,SAAS,CAACN,UAAV,CAAqBa,KAArB,GAA6B,EAAvC,CAAD,CAAZ;AACD,GAFQ,EAEP,CAACP,SAAD,CAFO,CAAT;;AAIA,QAAMQ,aAAa,GAAIC,MAAD,IAAY;AAChC,KAAC,YAAY;AACXZ,MAAAA,YAAY,CAAC,IAAD,CAAZ;;AACA,UAAI;AACF,cAAMa,QAAQ,GAAG,MAAMP,UAAU,CAC/BzB,YAAY,CAAC;AAAEU,UAAAA,IAAF;AAAQqB,UAAAA,MAAR;AAAgBE,UAAAA,aAAa,EAAEV,WAAW,CAACW;AAA3C,SAAD,CADmB,CAAjC;AAIAH,QAAAA,MAAM,CAACI,KAAP,GAAe,CAAAJ,MAAM,SAAN,IAAAA,MAAM,WAAN,YAAAA,MAAM,CAAEI,KAAR,IAAgBJ,MAAhB,aAAgBA,MAAhB,uBAAgBA,MAAM,CAAEI,KAAxB,GAAgC,EAA/C;AAEAC,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAmBL,QAAQ,CAACM,IAAT,CAActB,UAAd,CAAyBa,KAA5C;AACAR,QAAAA,YAAY,CAACM,IAAI,CAACC,IAAL,CAAUI,QAAQ,CAACM,IAAT,CAActB,UAAd,CAAyBa,KAAzB,IAAiCE,MAAjC,aAAiCA,MAAjC,uBAAiCA,MAAM,CAAEI,KAAzC,CAAV,CAAD,CAAZ;AAEAlB,QAAAA,aAAa,CAACe,QAAQ,CAAChB,UAAT,CAAoBa,KAArB,CAAb;AACAV,QAAAA,YAAY,CAAC,KAAD,CAAZ;AACD,OAZD,CAYE,OAAOoB,KAAP,EAAc;AACdpB,QAAAA,YAAY,CAAC,KAAD,CAAZ;;AACA,YAAIoB,KAAK,CAACP,QAAV,EAAoB;AAAA;;AAClB1B,UAAAA,YAAY,CAAC;AACXkC,YAAAA,MAAM,EAAE,OADG;AAEXC,YAAAA,WAAW,2BACTF,KAAK,CAACP,QAAN,CAAeM,IAAf,CAAoBI,OADX,yEAETjC,IAAI,CAACkC,aAAL,CAAmBlD,QAAQ,CAACmD,YAA5B;AAJS,WAAD,CAAZ;AAMD;AACF;AACF,KAzBD;AA0BD,GA3BD;;AA6BA,QAAMC,OAAO,GAAGhE,KAAK,CAACiE,OAAN,CACd,MAAM,CACJ;AACEC,IAAAA,MAAM,EAAE,OADV;AAEEC,IAAAA,QAAQ,EAAE,KAFZ;AAGEC,IAAAA,IAAI,EAAGC,OAAD,IAAa;AAAA;;AACjB,0BAAO,QAAC,GAAD;AAAA,kBAAM,CAAAA,OAAO,SAAP,IAAAA,OAAO,WAAP,4BAAAA,OAAO,CAAEC,GAAT,8DAAcC,KAAd,IAAsB;AAA5B;AAAA;AAAA;AAAA;AAAA,cAAP;AACD;AALH,GADI,EAQJ;AACEL,IAAAA,MAAM,EAAE,eADV;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GARI,EAaJ;AACED,IAAAA,MAAM,EAAE,eADV;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GAbI,EAiBJ;AACED,IAAAA,MAAM,EAAE,eADV;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GAjBI,EAqBJ;AACED,IAAAA,MAAM,EAAE,aADV;AAEEC,IAAAA,QAAQ,EAAGG,GAAD;AAAA;;AAAA,4BAASA,GAAG,CAACE,MAAb,gDAAS,YAAYC,UAArB;AAAA;AAFZ,GArBI,EAyBJ;AACEP,IAAAA,MAAM,EAAE,YADV;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GAzBI,EA6BJ;AACED,IAAAA,MAAM,EAAE,eADV;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GA7BI,EAiCJ;AACED,IAAAA,MAAM,EAAE,aADV;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GAjCI,EAqCJ;AACED,IAAAA,MAAM,EAAE,UADV;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GArCI,EAyCJ;AACED,IAAAA,MAAM,EAAE,QADV;AAEEC,IAAAA,QAAQ,EAAE,KAFZ;AAGEC,IAAAA,IAAI,EAAE,SAAa;AAAA,UAAZ;AAACM,QAAAA;AAAD,OAAY;AACjB,0BACE,QAAC,IAAD;AAAA,gCACE,QAAC,UAAD;AAAY,UAAA,CAAC,EAAE,CAAf;AAAkB,UAAA,EAAE,EAAEvE,MAAtB;AAAA,iCACE,QAAC,MAAD;AAAA,mCACE,QAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBADF,eAOE,QAAC,QAAD;AAAW,UAAA,OAAO,EAAE,MAAM;AACtB0C,YAAAA,OAAO,CAAC8B,IAAR,CAAc,aAAYD,KAAM,OAAhC;AACD,WAFH;AAAA,iCAGE,QAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAHF;AAAA;AAAA;AAAA;AAAA,gBAPF;AAAA;AAAA;AAAA;AAAA;AAAA,cADF;AAeD;AAnBH,GAzCI,CADQ,EAgEd,EAhEc,CAAhB;AAkEA,QAAME,cAAc,GAAG5E,KAAK,CAACiE,OAAN,CACrB,MAAM,CACJ;AACEC,IAAAA,MAAM,EAAE,OADV;AAEEC,IAAAA,QAAQ,EAAE,KAFZ;AAGEC,IAAAA,IAAI,EAAGC,OAAD,IAAa;AAAA;;AACjB,0BAAO,QAAC,GAAD;AAAA,kBAAM,CAAAA,OAAO,SAAP,IAAAA,OAAO,WAAP,6BAAAA,OAAO,CAAEC,GAAT,gEAAcC,KAAd,IAAsB;AAA5B;AAAA;AAAA;AAAA;AAAA,cAAP;AACD;AALH,GADI,EAQJ;AACEL,IAAAA,MAAM,EAAE,eADV;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GARI,EAaJ;AACED,IAAAA,MAAM,EAAE,eADV;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GAbI,EAiBJ;AACED,IAAAA,MAAM,EAAE,eADV;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GAjBI,EAqBJ;AACED,IAAAA,MAAM,EAAE,aADV;AAEEC,IAAAA,QAAQ,EAAGG,GAAD;AAAA;;AAAA,6BAASA,GAAG,CAACE,MAAb,iDAAS,aAAYC,UAArB;AAAA;AAFZ,GArBI,EAyBJ;AACEP,IAAAA,MAAM,EAAE,YADV;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GAzBI,EA6BJ;AACED,IAAAA,MAAM,EAAE,eADV;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GA7BI,EAiCJ;AACED,IAAAA,MAAM,EAAE,aADV;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GAjCI,EAqCJ;AACED,IAAAA,MAAM,EAAE,UADV;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GArCI,CADe,EA2CrB,EA3CqB,CAAvB;AA+CA,sBACE;AAAA,2BACE;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA,iBACG1B,SAAS,CAACgB,IAAV,CAAeoB,MAAf,GAAwB,CAAxB,IAA6BlC,aAA7B,iBACC,QAAC,GAAD;AAAK,QAAA,SAAS,EAAC,OAAf;AAAA,+BACE,QAAC,IAAD;AAAM,UAAA,EAAE,EAAC,eAAT;AAAA,iCACE,QAAC,MAAD;AAAQ,YAAA,OAAO,EAAC,QAAhB;AAAyB,YAAA,IAAI,EAAC,IAA9B;AAAA,oCACE;AAAG,cAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,oBADF,EAEGf,IAAI,CAACkC,aAAL,CAAmBlD,QAAQ,CAACkE,WAA5B,CAFH;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cAFJ,EAWG,CAACC,SAAS,CAACC,MAAX,gBACC,QAAC,KAAD;AACE,QAAA,OAAO,EAAE,MAAM;AACbpC,UAAAA,UAAU,CACRzB,YAAY,CAAC;AACXU,YAAAA,IADW;AAEXuB,YAAAA,aAAa,EAAEV,WAAW,CAACW,GAFhB;AAGXH,YAAAA,MAAM,EAAE;AAAEI,cAAAA,KAAK,EAAE,EAAT;AAAa2B,cAAAA,MAAM,EAAE;AAArB;AAHG,WAAD,CADJ,CAAV;AAOA7C,UAAAA,aAAa,CAAC,CAAD,CAAb;AACAI,UAAAA,YAAY,CAAC,CAAD,CAAZ;AACD,SAXH;AAYE,QAAA,KAAK,EAAEZ,IAAI,CAACkC,aAAL,CAAmBlD,QAAQ,CAACsE,iBAA5B,CAZT;AAaE,QAAA,OAAO,EAAEtD,IAAI,CAACkC,aAAL,CAAmBlD,QAAQ,CAACuE,mBAA5B,CAbX;AAcE,QAAA,WAAW,EAAEC;AAdf;AAAA;AAAA;AAAA;AAAA,cADD,GAiBG1D,WAAW,gBACb,QAAC,KAAD;AACE,QAAA,OAAO,EAAE,MACPP,YAAY,CAAC;AAAEU,UAAAA,IAAF;AAAQuB,UAAAA,aAAa,EAAEV,WAAW,CAACW;AAAnC,SAAD,CAFhB;AAIE,QAAA,KAAK,EAAEzB,IAAI,CAACkC,aAAL,CAAmBlD,QAAQ,CAACyE,gBAA5B,CAJT;AAKE,QAAA,OAAO,EAAEzD,IAAI,CAACkC,aAAL,CAAmBlD,QAAQ,CAAC0E,kBAA5B,CALX;AAME,QAAA,WAAW,EAAEF;AANf;AAAA;AAAA;AAAA;AAAA,cADa,GASXnD,OAAO,gBACT,QAAC,OAAD;AAAA;AAAA;AAAA;AAAA,cADS,GAEPQ,SAAS,CAACgB,IAAV,CAAeoB,MAAf,GAAwB,CAAxB;AAAA;;AACF;AACA,cAAC,GAAD;AAAK,QAAA,EAAE,EAAE,CAAT;AAAA,+BACE,QAAC,YAAD;AACE,UAAA,OAAO,EAAElC,aAAa,GAAEqB,OAAF,GAAYY,cADpC;AAEE,UAAA,IAAI,EAAEnC,SAAS,CAACgB,IAFlB;AAGE,UAAA,SAAS,EAAER,aAHb;AAIE,UAAA,UAAU,EAAEd,UAJd;AAKE,UAAA,mBAAmB,EAAEI,SALvB;AAME,UAAA,OAAO,EAAEF,SANX;AAOE,UAAA,aAAa,EAAE,IAPjB;AAQE,UAAA,MAAM,EAAE;AARV;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cAFE,gBAeF,QAAC,cAAD,OAAoBtB;AAApB;AAAA;AAAA;AAAA;AAAA,cAtDJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,UADF;AA6DD,CA9ND;;GAAMS,Y;UAESV,O,EACAJ,W,EAOXA,W,EACiBC,W,EACHY,U;;;KAZZC,Y;AAgON,eAAeA,YAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Button, Box, Menu,\r\n  MenuButton,\r\n  MenuList,\r\n  MenuItem,\r\n  Center\r\n } from '@chakra-ui/react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\n/* import { getWorkshops } from './actions'; */\r\nimport messages from './messages';\r\nimport serverErrorIllustrator from '../../assets/img/serverError.svg';\r\nimport Error from '../Error';\r\nimport { useIntl } from 'react-intl';\r\nimport './style.css';\r\nimport { optionsProp } from './constants';\r\nimport AdditionOption from '../../utils/AdditionOptions';\r\nimport { Loading } from '../Loading';\r\nimport { selectGlobalState, getWorkshops } from '../../globalSlice';\r\nimport { Link } from 'react-router-dom';\r\nimport DynamicTable from '../DynamicTable';\r\nimport { FiMoreVertical } from 'react-icons/fi';\r\nimport { useHistory } from 'react-router';\r\n\r\nconst WorkshopList = ({ notification }) => {\r\n  const [serverError, setServerError] = useState(false);\r\n  const intl = useIntl();\r\n  const auth = useSelector((state) => state.auth);\r\n  const [openBulk, setOpenBulk] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [totalCount, setTotalCount] = useState(0);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [pageCount, setPageCount] = useState(0);\r\n  const { workshops, distributor, isDistributor } =\r\n    useSelector(selectGlobalState);\r\n  const dispatcher = useDispatch();\r\n  const history = useHistory();\r\n\r\n\r\n  useEffect(() => {\r\n    setPageCount(Math.ceil(workshops.totalCount.count / 10));\r\n  },[workshops])\r\n\r\n  const fetchAllParts = (params) => {\r\n    (async () => {\r\n      setIsLoading(true);\r\n      try {\r\n        const response = await dispatcher(\r\n          getWorkshops({ auth, params, distributorId: distributor._id }),\r\n        );\r\n\r\n        params.limit = params?.limit ? params?.limit : 10;\r\n\r\n        console.log('XXX', response.data.totalCount.count)\r\n        setPageCount(Math.ceil(response.data.totalCount.count / params?.limit));\r\n\r\n        setTotalCount(response.totalCount.count);\r\n        setIsLoading(false);\r\n      } catch (error) {\r\n        setIsLoading(false);\r\n        if (error.response) {\r\n          notification({\r\n            status: 'error',\r\n            description:\r\n              error.response.data.message ??\r\n              intl.formatMessage(messages.errorMessage),\r\n          });\r\n        }\r\n      }\r\n    })();\r\n  };\r\n\r\n  const columns = React.useMemo(\r\n    () => [\r\n      {\r\n        Header: 'S. No',\r\n        accessor: 'sno',\r\n        Cell: (allData) => {\r\n          return <Box>{allData?.row?.index + 1}</Box>;\r\n        },\r\n      },\r\n      {\r\n        Header: 'Workshop Code',\r\n        accessor: 'code',\r\n      },\r\n\r\n      {\r\n        Header: 'Workshop Name',\r\n        accessor: 'name',\r\n      },\r\n      {\r\n        Header: 'Workshop Type',\r\n        accessor: 'type',\r\n      },\r\n      {\r\n        Header: 'Branch Code',\r\n        accessor: (row) => row.branch?.branchCode,\r\n      },\r\n      {\r\n        Header: 'Owner Name',\r\n        accessor: 'ownerFullName',\r\n      },\r\n      {\r\n        Header: 'Mobile Number',\r\n        accessor: 'mobileNumber',\r\n      },\r\n      {\r\n        Header: 'Credit Days',\r\n        accessor: 'creditDays',\r\n      },\r\n      {\r\n        Header: 'Discount',\r\n        accessor: 'discount',\r\n      },\r\n      {\r\n        Header: 'Action',\r\n        accessor: '_id',\r\n        Cell: ({value}) => {\r\n          return (\r\n            <Menu>\r\n              <MenuButton p={0} as={Button}>\r\n                <Center>\r\n                  <FiMoreVertical />\r\n                </Center>\r\n              </MenuButton>\r\n\r\n              <MenuList  onClick={() => {\r\n                  history.push(`/workshop/${value}/edit`);\r\n                }}>\r\n                <MenuItem>View Detail</MenuItem>\r\n              </MenuList>\r\n            </Menu>\r\n          );\r\n        }\r\n      }\r\n    ],\r\n    [],\r\n  );\r\n  const employeeColumn = React.useMemo(\r\n    () => [\r\n      {\r\n        Header: 'S. No',\r\n        accessor: 'sno',\r\n        Cell: (allData) => {\r\n          return <Box>{allData?.row?.index + 1}</Box>;\r\n        },\r\n      },\r\n      {\r\n        Header: 'Workshop Code',\r\n        accessor: 'code',\r\n      },\r\n\r\n      {\r\n        Header: 'Workshop Name',\r\n        accessor: 'name',\r\n      },\r\n      {\r\n        Header: 'Workshop Type',\r\n        accessor: 'type',\r\n      },\r\n      {\r\n        Header: 'Branch Code',\r\n        accessor: (row) => row.branch?.branchCode,\r\n      },\r\n      {\r\n        Header: 'Owner Name',\r\n        accessor: 'ownerFullName',\r\n      },\r\n      {\r\n        Header: 'Mobile Number',\r\n        accessor: 'mobileNumber',\r\n      },\r\n      {\r\n        Header: 'Credit Days',\r\n        accessor: 'creditDays',\r\n      },\r\n      {\r\n        Header: 'Discount',\r\n        accessor: 'discount',\r\n      },\r\n    ],\r\n    [],\r\n  );\r\n\r\n\r\n  return (\r\n    <div>\r\n      <div className='mb-0 p-1 pb-0 '>\r\n        {workshops.data.length > 0 && isDistributor && (\r\n          <Box textAlign='right'>\r\n            <Link to='/workshop/add'>\r\n              <Button variant='normal' size='md'>\r\n                <i className='fas fa-user-plus mr-2'></i>\r\n                {intl.formatMessage(messages.addWorkshop)}\r\n              </Button>\r\n            </Link>\r\n          </Box>\r\n        )}\r\n        {!navigator.onLine ? (\r\n          <Error\r\n            onRetry={() => {\r\n              dispatcher(\r\n                getWorkshops({\r\n                  auth,\r\n                  distributorId: distributor._id,\r\n                  params: { limit: 10, offset: 0 },\r\n                }),\r\n              );\r\n              setTotalCount(0);\r\n              setPageCount(0);\r\n            }}\r\n            title={intl.formatMessage(messages.networkErrorTitle)}\r\n            message={intl.formatMessage(messages.networkErrorMessage)}\r\n            illustrator={serverErrorIllustrator}\r\n          />\r\n        ) : serverError ? (\r\n          <Error\r\n            onRetry={() =>\r\n              getWorkshops({ auth, distributorId: distributor._id })\r\n            }\r\n            title={intl.formatMessage(messages.serverErrorTitle)}\r\n            message={intl.formatMessage(messages.serverErrorMessage)}\r\n            illustrator={serverErrorIllustrator}\r\n          />\r\n        ) : loading ? (\r\n          <Loading />\r\n        ) : workshops.data.length > 0 ? (\r\n          /*  <WorkshopTable workshops={workshops} isOpen={openBulk} /> */\r\n          <Box mt={6}>\r\n            <DynamicTable\r\n              columns={isDistributor? columns : employeeColumn}\r\n              data={workshops.data}\r\n              fetchData={fetchAllParts}\r\n              totalCount={totalCount}\r\n              controlledPageCount={pageCount}\r\n              loading={isLoading}\r\n              skipPageReset={true}\r\n              params={{}}\r\n            />\r\n          </Box>\r\n        ) : (\r\n          <AdditionOption {...optionsProp} />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WorkshopList;\r\n"]},"metadata":{},"sourceType":"module"}