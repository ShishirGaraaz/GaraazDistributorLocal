{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Acer\\\\Desktop\\\\Work\\\\garaaz-distributor\\\\src\\\\containers\\\\BranchList\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useMemo, useDispatch } from 'react';\nimport { useIntl } from 'react-intl';\nimport { useSelector } from 'react-redux';\nimport BranchItemCard from '../../components/BranchCard';\nimport messages from './messages';\nimport toast from 'react-hot-toast';\nimport Error from '../../components/Error';\nimport serverErrorIllustrator from \"../../assets/img/serverError.svg\";\nimport { optionsProp } from './constants';\nimport { Button } from '@chakra-ui/button';\nimport { Link } from 'react-router-dom';\nimport AdditionOption from '../../utils/AdditionOptions';\nimport './style.css';\nimport { Box, Image, Center, MenuButton, MenuList, Menu, MenuItem } from '@chakra-ui/react';\nimport DynamicTable from '../../components/DynamicTable';\nimport { Loading } from '../../components/Loading';\nimport { FiMoreVertical } from 'react-icons/fi';\nimport { useHistory } from 'react-router';\nimport { ROUTES } from '../../routes';\nimport ModifiedTableTop, { SingleInput } from '../../components/TableTop/ModifiedTableTop';\nimport downloadExcel from '../../utils/downloadExcel';\nimport { selectGlobalState } from '../../globalSlice';\nimport { setBranches, getBranchList, setTotalCount } from './actions';\nimport garaazLogo from '../../images/placeholderImage.jpg';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst BranchList = err => {\n  _s();\n\n  // const [branches, setBranches] = useState([]);\n  const {\n    branches,\n    isDistributor\n  } = useSelector(selectGlobalState);\n  const [tableData, setTableData] = useState([]);\n  const [serverError, setServerError] = useState(false);\n  const auth = useSelector(state => state.auth);\n  const [loading, setLoading] = useState(false);\n  const dispatcher = useDispatch();\n  const intl = useIntl();\n  const [pageCount, setPageCount] = useState(0);\n  const [isLoading, setIsLoading] = useState(false);\n  const history = useHistory();\n  const [filters, setFilters] = useState({\n    branchCode: '',\n    branchName: ''\n  });\n  console.log({\n    isDistributor\n  });\n\n  const getBranches = async () => {\n    try {\n      setLoading(true);\n      setTableData([...branches].reverse());\n      setServerError(false);\n      setLoading(false);\n    } catch (error) {\n      setLoading(false);\n      setServerError(true);\n      toast('Something went wrong!');\n    }\n  };\n\n  useEffect(() => {\n    getBranches();\n  }, [branches]); // const fetchAllBranches = (params) => {\n  //   (async () => {\n  //     setIsLoading(true);\n  //     try {\n  //       const response = await getBranchList(auth, params);\n  //       dispatcher(setBranches(response?.data));\n  //      params.limit = params?.limit? params?.limit : 10;\n  //       setPageCount(Math.ceil(response?.totalCount?.count / params?.limit));\n  //       dispatcher(setTotalCount(response?.totalCount?.count));\n  //       setIsLoading(false);\n  //     } catch (error) {\n  //       setIsLoading(false);\n  //       if (error.response) {\n  //         err({\n  //           status: 'error',\n  //           description:\n  //             error.response.data.message ??\n  //             intl.formatMessage(messages.errorMessage),\n  //         });\n  //       }\n  //     }\n  //   })();\n  // };\n\n  const renderImage = value => {\n    return /*#__PURE__*/_jsxDEV(Center, {\n      justifyContent: \"center\",\n      children: /*#__PURE__*/_jsxDEV(Image, {\n        width: \"5vw\",\n        src: value.startsWith('https') ? value : garaazLogo,\n        alt: \"part\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this);\n  };\n\n  const columns = useMemo(() => [{\n    Header: 'S. No',\n    accessor: 'sno',\n    Cell: allData => {\n      var _allData$row;\n\n      return /*#__PURE__*/_jsxDEV(Box, {\n        children: (allData === null || allData === void 0 ? void 0 : (_allData$row = allData.row) === null || _allData$row === void 0 ? void 0 : _allData$row.index) + 1\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 18\n      }, this);\n    }\n  }, {\n    Header: 'Image',\n    accessor: row => {\n      var _row$gallery, _row$gallery$;\n\n      return ((_row$gallery = row.gallery) === null || _row$gallery === void 0 ? void 0 : _row$gallery.length) > 0 ? (_row$gallery$ = row.gallery[0]) === null || _row$gallery$ === void 0 ? void 0 : _row$gallery$.path : 'thumbnail';\n    },\n    Cell: _ref => {\n      let {\n        value\n      } = _ref;\n      return renderImage(value);\n    }\n  }, {\n    Header: 'Branch Code',\n    accessor: 'branchCode'\n  }, {\n    Header: 'Branch Name',\n    accessor: 'branchName'\n  }, {\n    Header: 'Branch Address',\n    accessor: 'location[0].addressLine1'\n  }, {\n    Header: 'Mobile Number',\n    accessor: 'contact[0].alternateNumbers'\n  }, {\n    Header: 'Actions',\n    accessor: row => row._id,\n    Cell: allData => {\n      return /*#__PURE__*/_jsxDEV(Menu, {\n        children: [/*#__PURE__*/_jsxDEV(MenuButton, {\n          p: 0,\n          as: Button,\n          children: /*#__PURE__*/_jsxDEV(Center, {\n            children: /*#__PURE__*/_jsxDEV(FiMoreVertical, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(MenuList, {\n          children: /*#__PURE__*/_jsxDEV(MenuItem, {\n            onClick: () => history.push(`/branch/${allData.row.original._id}/edit`),\n            children: \"Edit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 13\n      }, this);\n    }\n  }], []);\n  const isEmployeeCol = useMemo(() => [{\n    Header: 'S. No',\n    accessor: 'sno',\n    Cell: allData => {\n      var _allData$row2;\n\n      return /*#__PURE__*/_jsxDEV(Box, {\n        children: (allData === null || allData === void 0 ? void 0 : (_allData$row2 = allData.row) === null || _allData$row2 === void 0 ? void 0 : _allData$row2.index) + 1\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 18\n      }, this);\n    }\n  }, {\n    Header: 'Image',\n    accessor: row => {\n      var _row$gallery2, _row$gallery$2;\n\n      return ((_row$gallery2 = row.gallery) === null || _row$gallery2 === void 0 ? void 0 : _row$gallery2.length) > 0 ? (_row$gallery$2 = row.gallery[0]) === null || _row$gallery$2 === void 0 ? void 0 : _row$gallery$2.path : 'thumbnail';\n    },\n    Cell: _ref2 => {\n      let {\n        value\n      } = _ref2;\n      return renderImage(value);\n    }\n  }, {\n    Header: 'Branch Code',\n    accessor: 'branchCode'\n  }, {\n    Header: 'Branch Name',\n    accessor: 'branchName'\n  }, {\n    Header: 'Branch Address',\n    accessor: 'location[0].addressLine1'\n  }, {\n    Header: 'Mobile Number',\n    accessor: 'contact[0].alternateNumbers'\n  }], []);\n  const inputData = useMemo(() => ({\n    title: 'Search',\n    type: 'text',\n    placeholder: '',\n    name: 'branchSearch',\n    width: '20%'\n  }), []);\n\n  const handleTableTopChange = async (e, name) => {\n    const value = e.hasOwnProperty('target') ? e.target.value : e;\n    const newFilters = { ...filters,\n      [name]: `${value}`.trim()\n    };\n    setFilters(newFilters);\n    setTableData(branches.filter(branch => {\n      return `${branch.branchCode}`.toLowerCase().indexOf(newFilters.branchSearch.toLowerCase()) !== -1 || `${branch.branchName}`.toLowerCase().indexOf(newFilters.branchSearch.toLowerCase()) !== -1;\n    }));\n  };\n\n  const handleExport = () => {\n    const refinedTableData = [...tableData].map(data => {\n      return {\n        'Branch Name': data.branchName,\n        'Branch Code': data.branchCode,\n        'Branch Address': data.location[0].addressLine1,\n        'Mobile Number': data.contact[0].alternateNumbers.join(',')\n      };\n    });\n    downloadExcel(refinedTableData, 'Branches.xlsx');\n  };\n\n  return /*#__PURE__*/_jsxDEV(Box, {\n    minHeight: \"68vh\",\n    children: [/*#__PURE__*/_jsxDEV(Box, {\n      children: branches.length > 0 && /*#__PURE__*/_jsxDEV(Box, {\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"space-between\",\n        children: [/*#__PURE__*/_jsxDEV(SingleInput, {\n          inputObj: inputData,\n          onChange: handleTableTopChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 13\n        }, this), isDistributor && /*#__PURE__*/_jsxDEV(Box, {\n          children: [/*#__PURE__*/_jsxDEV(Link, {\n            to: \"/branch/add\",\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"addition\",\n              size: \"md\",\n              children: intl.formatMessage(messages.addBranch)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: ROUTES.BRANCH_ADD_BULK,\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"addition\",\n              size: \"md\",\n              ml: 4,\n              children: intl.formatMessage(messages.uploadBranches)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: handleExport,\n            variant: \"addition\",\n            size: \"md\",\n            ml: 4,\n            children: intl.formatMessage(messages.exportToExcel)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-auto  pb-6 pt-0\",\n      children: serverError ? /*#__PURE__*/_jsxDEV(Error, {\n        onRetry: getBranches,\n        title: \"Server Error\",\n        message: \"Something went wrong, please try again!\",\n        illustrator: serverErrorIllustrator\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 11\n      }, this) : branches.length < 1 ? loading ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(AdditionOption, { ...optionsProp\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(Box, {\n        mt: 5,\n        children: /*#__PURE__*/_jsxDEV(DynamicTable, {\n          columns: columns,\n          data: tableData // fetchData={fetchAllBranches}\n          ,\n          controlledPageCount: pageCount,\n          skipPageReset: true // loading={isLoading}\n          //loading={tableLoading}\n          ,\n          hidePagination: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 254,\n    columnNumber: 5\n  }, this);\n};\n\n_s(BranchList, \"6lfZaGEiIqjT5RuDCtFGwsS3PAI=\", false, function () {\n  return [useSelector, useSelector, useDispatch, useIntl, useHistory];\n});\n\n_c = BranchList;\nexport default BranchList;\n\nvar _c;\n\n$RefreshReg$(_c, \"BranchList\");","map":{"version":3,"sources":["C:/Users/Acer/Desktop/Work/garaaz-distributor/src/containers/BranchList/index.js"],"names":["React","useEffect","useState","useMemo","useDispatch","useIntl","useSelector","BranchItemCard","messages","toast","Error","optionsProp","Button","Link","AdditionOption","Box","Image","Center","MenuButton","MenuList","Menu","MenuItem","DynamicTable","Loading","FiMoreVertical","useHistory","ROUTES","ModifiedTableTop","SingleInput","downloadExcel","selectGlobalState","setBranches","getBranchList","setTotalCount","garaazLogo","BranchList","err","branches","isDistributor","tableData","setTableData","serverError","setServerError","auth","state","loading","setLoading","dispatcher","intl","pageCount","setPageCount","isLoading","setIsLoading","history","filters","setFilters","branchCode","branchName","console","log","getBranches","reverse","error","renderImage","value","startsWith","columns","Header","accessor","Cell","allData","row","index","gallery","length","path","_id","push","original","isEmployeeCol","inputData","title","type","placeholder","name","width","handleTableTopChange","e","hasOwnProperty","target","newFilters","trim","filter","branch","toLowerCase","indexOf","branchSearch","handleExport","refinedTableData","map","data","location","addressLine1","contact","alternateNumbers","join","formatMessage","addBranch","BRANCH_ADD_BULK","uploadBranches","exportToExcel","serverErrorIllustrator"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useMemo,useDispatch} from 'react';\r\nimport { useIntl } from 'react-intl';\r\nimport { useSelector } from 'react-redux';\r\nimport BranchItemCard from '../../components/BranchCard';\r\nimport messages from './messages';\r\nimport toast from 'react-hot-toast';\r\nimport Error from '../../components/Error';\r\nimport serverErrorIllustrator from '../../assets/img/serverError.svg';\r\nimport { optionsProp } from './constants';\r\nimport { Button } from '@chakra-ui/button';\r\nimport { Link } from 'react-router-dom';\r\nimport AdditionOption from '../../utils/AdditionOptions';\r\n\r\nimport './style.css';\r\nimport {\r\n  Box,\r\n  Image,\r\n  Center,\r\n  MenuButton,\r\n  MenuList,\r\n  Menu,\r\n  MenuItem,\r\n} from '@chakra-ui/react';\r\nimport DynamicTable from '../../components/DynamicTable';\r\nimport { Loading } from '../../components/Loading';\r\nimport { FiMoreVertical } from 'react-icons/fi';\r\nimport { useHistory } from 'react-router';\r\nimport { ROUTES } from '../../routes';\r\nimport ModifiedTableTop, {\r\n  SingleInput,\r\n} from '../../components/TableTop/ModifiedTableTop';\r\nimport downloadExcel from '../../utils/downloadExcel';\r\nimport { selectGlobalState } from '../../globalSlice';\r\nimport { setBranches, getBranchList, setTotalCount} from './actions';\r\nimport garaazLogo from '../../images/placeholderImage.jpg';\r\n\r\nconst BranchList = (err) => {\r\n  // const [branches, setBranches] = useState([]);\r\n  const { branches, isDistributor } = useSelector(selectGlobalState);\r\n  const [tableData, setTableData] = useState([]);\r\n  const [serverError, setServerError] = useState(false);\r\n  const auth = useSelector((state) => state.auth);\r\n  const [loading, setLoading] = useState(false);\r\n  const dispatcher = useDispatch();\r\n  const intl = useIntl();\r\n  const [pageCount, setPageCount] = useState(0);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const history = useHistory();\r\n  const [filters, setFilters] = useState({\r\n    branchCode: '',\r\n    branchName: '',\r\n  });\r\n\r\n  console.log({ isDistributor });\r\n\r\n  const getBranches = async () => {\r\n    try {\r\n      setLoading(true);\r\n\r\n      setTableData([...branches].reverse());\r\n      setServerError(false);\r\n      setLoading(false);\r\n    } catch (error) {\r\n      setLoading(false);\r\n      setServerError(true);\r\n      toast('Something went wrong!');\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    getBranches();\r\n  }, [branches]);\r\n\r\n  // const fetchAllBranches = (params) => {\r\n  //   (async () => {\r\n  //     setIsLoading(true);\r\n  //     try {\r\n  //       const response = await getBranchList(auth, params);\r\n\r\n  //       dispatcher(setBranches(response?.data));\r\n\r\n  //      params.limit = params?.limit? params?.limit : 10;\r\n  //       setPageCount(Math.ceil(response?.totalCount?.count / params?.limit));\r\n\r\n  //       dispatcher(setTotalCount(response?.totalCount?.count));\r\n  //       setIsLoading(false);\r\n  //     } catch (error) {\r\n  //       setIsLoading(false);\r\n  //       if (error.response) {\r\n  //         err({\r\n  //           status: 'error',\r\n  //           description:\r\n  //             error.response.data.message ??\r\n  //             intl.formatMessage(messages.errorMessage),\r\n  //         });\r\n  //       }\r\n  //     }\r\n  //   })();\r\n  // };\r\n\r\n  const renderImage = (value) => {\r\n    return (\r\n      <Center justifyContent='center'>\r\n        <Image\r\n          width='5vw'\r\n          src={value.startsWith('https') ? value : garaazLogo}\r\n          alt='part'\r\n        />\r\n      </Center>\r\n    );\r\n  };\r\n\r\n  const columns = useMemo(\r\n    () => [\r\n      {\r\n        Header: 'S. No',\r\n        accessor: 'sno',\r\n        Cell: (allData) => {\r\n          return <Box>{allData?.row?.index + 1}</Box>;\r\n        },\r\n      },\r\n      {\r\n        Header: 'Image',\r\n        accessor: (row) =>\r\n          row.gallery?.length > 0 ? row.gallery[0]?.path : 'thumbnail',\r\n        Cell: ({ value }) => renderImage(value),\r\n      },\r\n\r\n      {\r\n        Header: 'Branch Code',\r\n        accessor: 'branchCode',\r\n      },\r\n      {\r\n        Header: 'Branch Name',\r\n        accessor: 'branchName',\r\n      },\r\n      {\r\n        Header: 'Branch Address',\r\n        accessor: 'location[0].addressLine1',\r\n      },\r\n      {\r\n        Header: 'Mobile Number',\r\n        accessor: 'contact[0].alternateNumbers',\r\n      },\r\n      {\r\n        Header: 'Actions',\r\n        accessor: (row) => row._id,\r\n        Cell: (allData) => {\r\n          return (\r\n            <Menu>\r\n              <MenuButton p={0} as={Button}>\r\n                <Center>\r\n                  <FiMoreVertical />\r\n                </Center>\r\n              </MenuButton>\r\n\r\n              <MenuList>\r\n                <MenuItem\r\n                  onClick={() =>\r\n                    history.push(`/branch/${allData.row.original._id}/edit`)\r\n                  }\r\n                >\r\n                  Edit\r\n                </MenuItem>\r\n              </MenuList>\r\n            </Menu>\r\n          );\r\n        },\r\n      },\r\n    ],\r\n    [],\r\n  );\r\n\r\n  const isEmployeeCol = useMemo(\r\n    () => [\r\n      {\r\n        Header: 'S. No',\r\n        accessor: 'sno',\r\n        Cell: (allData) => {\r\n          return <Box>{allData?.row?.index + 1}</Box>;\r\n        },\r\n      },\r\n      {\r\n        Header: 'Image',\r\n        accessor: (row) =>\r\n          row.gallery?.length > 0 ? row.gallery[0]?.path : 'thumbnail',\r\n        Cell: ({ value }) => renderImage(value),\r\n      },\r\n\r\n      {\r\n        Header: 'Branch Code',\r\n        accessor: 'branchCode',\r\n      },\r\n      {\r\n        Header: 'Branch Name',\r\n        accessor: 'branchName',\r\n      },\r\n      {\r\n        Header: 'Branch Address',\r\n        accessor: 'location[0].addressLine1',\r\n      },\r\n      {\r\n        Header: 'Mobile Number',\r\n        accessor: 'contact[0].alternateNumbers',\r\n      },\r\n    ],\r\n    [],\r\n  );\r\n\r\n  const inputData = useMemo(\r\n    () => ({\r\n      title: 'Search',\r\n      type: 'text',\r\n      placeholder: '',\r\n      name: 'branchSearch',\r\n      width: '20%',\r\n    }),\r\n\r\n    [],\r\n  );\r\n\r\n  const handleTableTopChange = async (e, name) => {\r\n    const value = e.hasOwnProperty('target') ? e.target.value : e;\r\n    const newFilters = { ...filters, [name]: `${value}`.trim() };\r\n    setFilters(newFilters);\r\n\r\n    setTableData(\r\n      branches.filter((branch) => {\r\n        return (\r\n          `${branch.branchCode}`\r\n            .toLowerCase()\r\n            .indexOf(newFilters.branchSearch.toLowerCase()) !== -1 ||\r\n          `${branch.branchName}`\r\n            .toLowerCase()\r\n            .indexOf(newFilters.branchSearch.toLowerCase()) !== -1\r\n        );\r\n      }),\r\n    );\r\n  };\r\n\r\n  const handleExport = () => {\r\n    const refinedTableData = [...tableData].map((data) => {\r\n      return {\r\n        'Branch Name': data.branchName,\r\n        'Branch Code': data.branchCode,\r\n        'Branch Address': data.location[0].addressLine1,\r\n        'Mobile Number': data.contact[0].alternateNumbers.join(','),\r\n      };\r\n    });\r\n    downloadExcel(refinedTableData, 'Branches.xlsx');\r\n  };\r\n\r\n  return (\r\n    <Box minHeight='68vh'>\r\n      <Box>\r\n        {branches.length > 0 && (\r\n          <Box\r\n            display='flex'\r\n            alignItems='center'\r\n            justifyContent='space-between'\r\n          >\r\n            <SingleInput inputObj={inputData} onChange={handleTableTopChange} />\r\n            {isDistributor && (\r\n              <Box>\r\n                <Link to='/branch/add'>\r\n                  <Button variant='addition' size='md'>\r\n                    {intl.formatMessage(messages.addBranch)}\r\n                  </Button>\r\n                </Link>\r\n                <Link to={ROUTES.BRANCH_ADD_BULK}>\r\n                  <Button variant='addition' size='md' ml={4}>\r\n                    {intl.formatMessage(messages.uploadBranches)}\r\n                  </Button>\r\n                </Link>\r\n                <Button\r\n                  onClick={handleExport}\r\n                  variant='addition'\r\n                  size='md'\r\n                  ml={4}\r\n                >\r\n                  {intl.formatMessage(messages.exportToExcel)}\r\n                </Button>\r\n              </Box>\r\n            )}\r\n          </Box>\r\n        )}\r\n      </Box>\r\n      <div className='flex-auto  pb-6 pt-0'>\r\n        {serverError ? (\r\n          <Error\r\n            onRetry={getBranches}\r\n            title='Server Error'\r\n            message='Something went wrong, please try again!'\r\n            illustrator={serverErrorIllustrator}\r\n          />\r\n        ) : branches.length < 1 ? (\r\n          loading ? (\r\n            <Loading />\r\n          ) : (\r\n            <AdditionOption {...optionsProp} />\r\n          )\r\n        ) : (\r\n          <Box mt={5}>\r\n            <DynamicTable\r\n              columns={columns}\r\n              data={tableData}\r\n              // fetchData={fetchAllBranches}\r\n              controlledPageCount={pageCount}\r\n              skipPageReset={true}\r\n              // loading={isLoading}\r\n              //loading={tableLoading}\r\n              hidePagination={true}\r\n            />\r\n          </Box>\r\n        )}\r\n      </div>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default BranchList;\r\n"]},"metadata":{},"sourceType":"module"}