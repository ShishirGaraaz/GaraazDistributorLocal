{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RelativeCursorPositionObserver = void 0;\n\nclass RelativeCursorPositionObserver {\n  get subject() {\n    return this._subject;\n  }\n\n  set subject(value) {\n    this._subject = value;\n  }\n\n  get documentRelativeElementOffset() {\n    if (!this._subject) {\n      throw new Error('Not yet initialized. Subject is not set');\n    }\n\n    if (!this.elementOffset) {\n      this.elementOffset = this.getDocumentRelativeElementOffset(this._subject);\n    }\n\n    return this.elementOffset;\n  }\n\n  getDocumentRelativeElementOffset(el) {\n    const rootEl = this.getRootOfEl(el);\n    const {\n      left: docLeft,\n      top: docTop\n    } = rootEl.getBoundingClientRect();\n    const {\n      left: elLeft,\n      top: elTop\n    } = el.getBoundingClientRect();\n    return {\n      x: Math.abs(docLeft) + elLeft,\n      y: Math.abs(docTop) + elTop\n    };\n  }\n\n  getRootOfEl(el) {\n    if (el.parentElement) {\n      return this.getRootOfEl(el.parentElement);\n    }\n\n    return el;\n  }\n\n  getComputedElementRelativeCursorPosition(event, documentRelativeElementOffset) {\n    const position = this.getDocumentRelativeCursorPosition(event);\n    const {\n      x: cursorX,\n      y: cursorY\n    } = position;\n    const {\n      x: offsetX,\n      y: offsetY\n    } = documentRelativeElementOffset;\n    return {\n      x: Math.round(cursorX - offsetX),\n      y: Math.round(cursorY - offsetY)\n    };\n  }\n\n  getDocumentRelativeCursorPosition(event) {\n    return {\n      x: event.pageX,\n      y: event.pageY\n    };\n  }\n\n  getCursorPosition(event) {\n    return this.getComputedElementRelativeCursorPosition(event, this.documentRelativeElementOffset);\n  }\n\n}\n\nexports.RelativeCursorPositionObserver = RelativeCursorPositionObserver;","map":{"version":3,"sources":["../../../src/lib/RelativeCursorPositionObserver.ts"],"names":[],"mappings":";;;;;;;AAKA,MAAa,8BAAb,CAA2C;AAK5B,MAAP,OAAO,GAAA;AACP,WAAO,KAAK,QAAZ;AACH;;AAEU,MAAP,OAAO,CAAC,KAAD,EAA+B;AACtC,SAAK,QAAL,GAAgB,KAAhB;AACH;;AAEgC,MAA7B,6BAA6B,GAAA;AAC7B,QAAI,CAAC,KAAK,QAAV,EAAoB;AAChB,YAAM,IAAI,KAAJ,CAAU,yCAAV,CAAN;AACH;;AAED,QAAI,CAAC,KAAK,aAAV,EAAyB;AACrB,WAAK,aAAL,GAAqB,KAAK,gCAAL,CAAsC,KAAK,QAA3C,CAArB;AACH;;AAED,WAAO,KAAK,aAAZ;AACH;;AAED,EAAA,gCAAgC,CAAC,EAAD,EAAgB;AAC5C,UAAM,MAAM,GAAG,KAAK,WAAL,CAAiB,EAAjB,CAAf;AACA,UAAM;AACF,MAAA,IAAI,EAAE,OADJ;AAEF,MAAA,GAAG,EAAE;AAFH,QAGF,MAAM,CAAC,qBAAP,EAHJ;AAKA,UAAM;AACF,MAAA,IAAI,EAAE,MADJ;AAEF,MAAA,GAAG,EAAE;AAFH,QAGF,EAAE,CAAC,qBAAH,EAHJ;AAKA,WAAO;AACH,MAAA,CAAC,EAAE,IAAI,CAAC,GAAL,CAAS,OAAT,IAAoB,MADpB;AAEH,MAAA,CAAC,EAAE,IAAI,CAAC,GAAL,CAAS,MAAT,IAAmB;AAFnB,KAAP;AAIH;;AAED,EAAA,WAAW,CAAC,EAAD,EAAgB;AACvB,QAAI,EAAE,CAAC,aAAP,EAAsB;AAClB,aAAO,KAAK,WAAL,CAAiB,EAAE,CAAC,aAApB,CAAP;AACH;;AACD,WAAO,EAAP;AACH;;AAED,EAAA,wCAAwC,CACpC,KADoC,EAEpC,6BAFoC,EAEA;AAEpC,UAAM,QAAQ,GAAG,KAAK,iCAAL,CAAuC,KAAvC,CAAjB;AACA,UAAM;AAAE,MAAA,CAAC,EAAE,OAAL;AAAc,MAAA,CAAC,EAAE;AAAjB,QAA6B,QAAnC;AACA,UAAM;AAAE,MAAA,CAAC,EAAE,OAAL;AAAc,MAAA,CAAC,EAAE;AAAjB,QAA6B,6BAAnC;AAEA,WAAO;AACH,MAAA,CAAC,EAAE,IAAI,CAAC,KAAL,CAAW,OAAO,GAAG,OAArB,CADA;AAEH,MAAA,CAAC,EAAE,IAAI,CAAC,KAAL,CAAW,OAAO,GAAG,OAArB;AAFA,KAAP;AAIH;;AAED,EAAA,iCAAiC,CAAC,KAAD,EAA0B;AACvD,WAAO;AACH,MAAA,CAAC,EAAE,KAAK,CAAC,KADN;AAEH,MAAA,CAAC,EAAE,KAAK,CAAC;AAFN,KAAP;AAIH;;AAED,EAAA,iBAAiB,CAAC,KAAD,EAA0B;AACvC,WAAO,KAAK,wCAAL,CAA8C,KAA9C,EAAqD,KAAK,6BAA1D,CAAP;AACH;;AAzEsC;;AAA3C,OAAA,CAAA,8BAAA,GAAA,8BAAA","sourcesContent":["/* eslint-disable no-underscore-dangle */\nimport { MouseEvent } from 'react';\n\nimport type { Point } from 'src/types';\n\nexport class RelativeCursorPositionObserver {\n    protected _subject?: HTMLElement;\n\n    protected elementOffset?: Point;\n\n    get subject(): HTMLElement | undefined {\n        return this._subject;\n    }\n\n    set subject(value: HTMLElement | undefined) {\n        this._subject = value;\n    }\n\n    get documentRelativeElementOffset(): Point {\n        if (!this._subject) {\n            throw new Error('Not yet initialized. Subject is not set');\n        }\n\n        if (!this.elementOffset) {\n            this.elementOffset = this.getDocumentRelativeElementOffset(this._subject);\n        }\n\n        return this.elementOffset;\n    }\n\n    getDocumentRelativeElementOffset(el: HTMLElement): Point {\n        const rootEl = this.getRootOfEl(el);\n        const {\n            left: docLeft,\n            top: docTop,\n        } = rootEl.getBoundingClientRect();\n\n        const {\n            left: elLeft,\n            top: elTop,\n        } = el.getBoundingClientRect();\n\n        return {\n            x: Math.abs(docLeft) + elLeft,\n            y: Math.abs(docTop) + elTop,\n        };\n    }\n\n    getRootOfEl(el: HTMLElement): HTMLElement {\n        if (el.parentElement) {\n            return this.getRootOfEl(el.parentElement);\n        }\n        return el;\n    }\n\n    getComputedElementRelativeCursorPosition(\n        event: MouseEvent | Touch,\n        documentRelativeElementOffset: Point,\n    ): Point {\n        const position = this.getDocumentRelativeCursorPosition(event);\n        const { x: cursorX, y: cursorY } = position;\n        const { x: offsetX, y: offsetY } = documentRelativeElementOffset;\n\n        return {\n            x: Math.round(cursorX - offsetX),\n            y: Math.round(cursorY - offsetY),\n        };\n    }\n\n    getDocumentRelativeCursorPosition(event: MouseEvent | Touch): Point {\n        return {\n            x: event.pageX,\n            y: event.pageY,\n        };\n    }\n\n    getCursorPosition(event: MouseEvent | Touch): Point {\n        return this.getComputedElementRelativeCursorPosition(event, this.documentRelativeElementOffset);\n    }\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"script"}