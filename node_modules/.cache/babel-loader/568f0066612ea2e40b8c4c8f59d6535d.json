{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Acer\\\\Desktop\\\\Work\\\\garaaz-distributor\\\\src\\\\components\\\\InviteResponse\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { useHistory, useParams } from 'react-router';\nimport { publicAxios as axios } from '../../axios';\nimport { useDispatch } from 'react-redux';\nimport { attemptLogin } from '../../containers/LoginPage/actions';\nimport logo from '../../images/logo.png';\nimport toast from 'react-hot-toast';\nimport get from 'lodash/get';\nimport InviteEnvelop from './InviteAnimate';\nimport withToast from '../../HOCs/withToast';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Invite = _ref => {\n  _s();\n\n  let {\n    notification\n  } = _ref;\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const params = useParams();\n  const [invites, setInvite] = useState([]);\n\n  const handleSubmit = async (inviteToken, response) => {\n    try {\n      const res = await axios.patch('/employees/invites', {\n        // action: \"ACCEPTED\",\n        inviteToken: inviteToken,\n        action: response\n      });\n\n      if (response === 'ACCEPTED') {\n        dispatch(attemptLogin(get(res, 'data', {})));\n        history.push('/dashboard');\n        localStorage.removeItem('invite');\n      } else {\n        setInvite(invites.filter(invite => {\n          if (invites.length === 1) {\n            toast('You rejected all invites');\n            history.push('/login');\n          } else {\n            return invite.inviteToken !== inviteToken;\n          }\n        })); //insted of this will call get invites again\n      }\n    } catch (error) {\n      if (error.response) {\n        var _error$response$data;\n\n        notification({\n          status: 'error',\n          title: 'Expired invitation link',\n          description: (_error$response$data = error.response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.errorMsg\n        });\n      } else {\n        toast(error.response.data.message);\n        setInvite(invites.filter(invite => invite.inviteToken !== inviteToken));\n      }\n    }\n  };\n\n  useEffect(() => {\n    const token = history.location.search.split('token=')[1];\n\n    try {\n      const decodedToken = atob(decodeURIComponent(token));\n      setInvite([JSON.parse(decodedToken)]);\n    } catch (error) {\n      alert('Invite expired or invalid link');\n      history.push('/');\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'space-between',\n      height: '100vh',\n      alignItems: 'center',\n      flexDirection: 'column'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      style: {\n        fontWeight: 'bold',\n        fontSize: '23px',\n        bottom: '100vh'\n      },\n      children: \"Welcome to Garaaz\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(InviteEnvelop, {\n      handleSubmit: handleSubmit,\n      invites: invites\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {},\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: logo,\n            width: \"40\",\n            height: \"40\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            style: {\n              fontWeight: 'bolder',\n              fontSize: '24px',\n              paddingTop: '5px'\n            },\n            children: \"Garaaz\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Copyright \\xA9 2021 all rights reserved\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Invite, \"psEbIf0OvUa/a8DdflGbr8D2ZhQ=\", false, function () {\n  return [useDispatch, useHistory, useParams];\n});\n\n_c = Invite;\nexport default _c2 = withToast(Invite);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Invite\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["C:/Users/Acer/Desktop/Work/garaaz-distributor/src/components/InviteResponse/index.js"],"names":["React","useEffect","useState","useForm","useHistory","useParams","publicAxios","axios","useDispatch","attemptLogin","logo","toast","get","InviteEnvelop","withToast","Invite","notification","dispatch","history","params","invites","setInvite","handleSubmit","inviteToken","response","res","patch","action","push","localStorage","removeItem","filter","invite","length","error","status","title","description","data","errorMsg","message","token","location","search","split","decodedToken","atob","decodeURIComponent","JSON","parse","alert","display","justifyContent","height","alignItems","flexDirection","fontWeight","fontSize","bottom","paddingTop"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useForm } from 'react-hook-form';\r\nimport { useHistory, useParams } from 'react-router';\r\nimport { publicAxios as axios } from '../../axios';\r\nimport { useDispatch } from 'react-redux';\r\nimport { attemptLogin } from '../../containers/LoginPage/actions';\r\nimport logo from '../../images/logo.png';\r\nimport toast from 'react-hot-toast';\r\nimport get from 'lodash/get';\r\nimport InviteEnvelop from './InviteAnimate';\r\nimport withToast from '../../HOCs/withToast';\r\n\r\nconst Invite = ({ notification }) => {\r\n  const dispatch = useDispatch();\r\n  const history = useHistory();\r\n  const params = useParams();\r\n\r\n  const [invites, setInvite] = useState([]);\r\n\r\n  const handleSubmit = async (inviteToken, response) => {\r\n    try {\r\n      const res = await axios.patch('/employees/invites', {\r\n        // action: \"ACCEPTED\",\r\n        inviteToken: inviteToken,\r\n        action: response,\r\n      });\r\n\r\n      if (response === 'ACCEPTED') {\r\n        dispatch(attemptLogin(get(res, 'data', {})));\r\n        history.push('/dashboard');\r\n        localStorage.removeItem('invite');\r\n      } else {\r\n        setInvite(\r\n          invites.filter((invite) => {\r\n            if (invites.length === 1) {\r\n              toast('You rejected all invites');\r\n              history.push('/login');\r\n            } else {\r\n              return invite.inviteToken !== inviteToken;\r\n            }\r\n          }),\r\n        ); //insted of this will call get invites again\r\n      }\r\n    } catch (error) {\r\n      if (error.response) {\r\n        notification({\r\n          status: 'error',\r\n          title: 'Expired invitation link',\r\n          description: error.response.data?.errorMsg,\r\n        });\r\n      } else {\r\n        toast(error.response.data.message);\r\n        setInvite(\r\n          invites.filter((invite) => invite.inviteToken !== inviteToken),\r\n        );\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const token = history.location.search.split('token=')[1];\r\n    try {\r\n      const decodedToken = atob(decodeURIComponent(token));\r\n      setInvite([JSON.parse(decodedToken)]);\r\n    } catch (error) {\r\n      alert('Invite expired or invalid link');\r\n      history.push('/');\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        display: 'flex',\r\n        justifyContent: 'space-between',\r\n        height: '100vh',\r\n        alignItems: 'center',\r\n        flexDirection: 'column',\r\n      }}\r\n    >\r\n      <h3 style={{ fontWeight: 'bold', fontSize: '23px', bottom: '100vh' }}>\r\n        Welcome to Garaaz\r\n      </h3>\r\n      <InviteEnvelop handleSubmit={handleSubmit} invites={invites} />\r\n      <div style={{}}>\r\n        <div>\r\n          <div style={{ display: 'flex', justifyContent: 'center' }}>\r\n            <img src={logo} width='40' height='40'></img>\r\n            <h4\r\n              style={{\r\n                fontWeight: 'bolder',\r\n                fontSize: '24px',\r\n                paddingTop: '5px',\r\n              }}\r\n            >\r\n              Garaaz\r\n            </h4>\r\n          </div>\r\n        </div>\r\n        <p>Copyright © 2021 all rights reserved</p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default withToast(Invite);\r\n"]},"metadata":{},"sourceType":"module"}