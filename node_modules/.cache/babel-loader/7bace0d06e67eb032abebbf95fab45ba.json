{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Acer\\\\Desktop\\\\Work\\\\garaaz-distributor\\\\src\\\\containers\\\\Inventory\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useMemo, useState, useRef, useEffect } from 'react';\nimport { useIntl } from 'react-intl';\nimport { Box, Button, Link, useDisclosure, Alert, AlertIcon, AlertDescription } from '@chakra-ui/react';\nimport readXlsxFile from 'read-excel-file';\nimport { useSelector, useDispatch } from 'react-redux';\nimport moment from 'moment';\nimport { useRouteMatch, Switch, Route, Link as ReactLink } from 'react-router-dom';\nimport DynamicTable from '../../components/DynamicTable';\nimport ModifiedTableTop, { generateInput } from '../../components/TableTop/ModifiedTableTop';\nimport SimpleModal from '../../components/Modal';\nimport withToast from '../../HOCs/withToast';\nimport getMoneyFormat from '../../utils/getMoneyFormat';\nimport getCamelCase from '../../utils/getCamelCase';\nimport { selectGlobalState } from '../../globalSlice';\nimport messages from './messages';\nimport { getAllStock, selectInventory, uploadStock, getBranchStocks } from './slice';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst selectBranch = {\n  title: 'Select Branch',\n  type: 'select',\n  placeholder: 'Select option',\n  name: 'groupBy',\n  fullWidth: true,\n  options: []\n};\nconst mapSelect = [{\n  title: 'Location Code',\n  type: 'select',\n  placeholder: 'Select option',\n  name: 'locationCode',\n  isDisabled: false,\n  fullWidth: true,\n  defaultValue: {\n    value: 'Loc Code',\n    label: 'Loc Code'\n  },\n  options: [{\n    value: 'none',\n    label: 'None'\n  }, {\n    value: 'Loc Code',\n    label: 'Loc Code'\n  }]\n}, {\n  title: 'Part Number',\n  type: 'select',\n  placeholder: 'Select option',\n  name: 'partNumber',\n  fullWidth: true,\n  options: [{\n    value: 'none',\n    label: 'None'\n  }, {\n    value: 'Loc Code',\n    label: 'Loc Code'\n  }]\n}, {\n  title: 'Batch Code',\n  type: 'select',\n  placeholder: 'Select option',\n  name: 'batchCode',\n  fullWidth: true,\n  options: [{\n    value: 'none',\n    label: 'None'\n  }, {\n    value: 'Loc Code',\n    label: 'Loc Code'\n  }]\n}, {\n  title: 'Quantity',\n  type: 'select',\n  placeholder: 'Select option',\n  name: 'quantity',\n  fullWidth: true,\n  options: [{\n    value: 'none',\n    label: 'None'\n  }, {\n    value: 'Loc Code',\n    label: 'Loc Code'\n  }]\n}, {\n  title: 'Price',\n  type: 'select',\n  placeholder: 'Select option',\n  name: 'price',\n  fullWidth: true,\n  options: [{\n    value: 'none',\n    label: 'None'\n  }, {\n    value: 'Loc Code',\n    label: 'Loc Code'\n  }]\n}, {\n  title: 'Bin Location',\n  type: 'select',\n  placeholder: 'Select option',\n  name: 'binLocation',\n  fullWidth: true,\n  options: [{\n    value: 'none',\n    label: 'None'\n  }, {\n    value: 'Loc Code',\n    label: 'Loc Code'\n  }]\n}];\n\nconst Inventory = _ref => {\n  _s();\n\n  var _selectedBranch$branc4;\n\n  let {\n    notification\n  } = _ref;\n  const [inputValues, setInputValue] = useState({\n    start: moment().format('DD-MM-YYYY'),\n    end: moment().startOf('month').format('DD-MM-YYYY')\n  });\n  const intl = useIntl();\n  const importExcelRef = useRef();\n  const [isLoading, setIsLoading] = useState(false);\n  const {\n    allStock\n  } = useSelector(selectInventory);\n  const [batchinventoryList, setBatchinventoryList] = useState({\n    part: {},\n    batchinventory: []\n  });\n  const auth = useSelector(state => state.auth);\n  const dispatcher = useDispatch();\n  const {\n    url,\n    path\n  } = useRouteMatch();\n  const [tableLoading, setTableLoading] = useState(false);\n  const {\n    isOpen,\n    onOpen,\n    onClose\n  } = useDisclosure();\n  const {\n    isOpen: mapingModalOpen,\n    onOpen: onMapingModalOpen,\n    onClose: onMapingModalClose\n  } = useDisclosure();\n  const {\n    isOpen: stockDataOpen,\n    onOpen: onStockDataOpen,\n    onClose: onStockDataClose\n  } = useDisclosure();\n  const {\n    isOpen: openSingleEntryDetail,\n    onOpen: onOpenSingleEntryDetail,\n    onClose: onCloseSingleEntryDetail\n  } = useDisclosure();\n  const [selectbranchComponent, setSelectbranchComponent] = useState(selectBranch);\n  const [selectedBranch, setSelectBranch] = useState({});\n  const [mappingSelectState, setMapingSelectState] = useState(mapSelect);\n  const [processingImport, setProcessingImport] = useState(false);\n  const [rawImportedData, setRawImportedData] = useState([]);\n  const [mapKeys, setMapKey] = useState({});\n  const [processedImportedData, setProcessedImportedData] = useState([]);\n  const {\n    branches,\n    isDistributor\n  } = useSelector(selectGlobalState);\n  useEffect(() => {\n    (async () => {\n      try {\n        await dispatcher(getAllStock({\n          auth,\n          params: { ...inputValues\n          }\n        }));\n        const refinedBranch = [...branches].map(e => {\n          return {\n            value: e,\n            label: e.branchName\n          };\n        });\n        setSelectbranchComponent(prev => ({ ...prev,\n          options: refinedBranch\n        }));\n      } catch (error) {}\n    })();\n  }, [branches]);\n  const inputData = useMemo(() => [\n  /* {\r\n    title: intl.formatMessage(messages.inventoryDetailSearch),\r\n    type: 'text',\r\n    placeholder: '',\r\n    name: 'searchAccount',\r\n  },\r\n  {\r\n    title: intl.formatMessage(messages.groupBy),\r\n    type: 'select',\r\n    placeholder: 'Select option',\r\n    name: 'groupBy',\r\n    options: [\r\n      {\r\n        value: 'none',\r\n        label: 'None',\r\n      },\r\n      {\r\n        value: 'Loc Code',\r\n        label: intl.formatMessage(messages.locCode),\r\n      },\r\n    ],\r\n  }, */\n  {\n    title: intl.formatMessage(messages.filterByBranch),\n    type: 'select',\n    placeholder: intl.formatMessage(messages.selectBranch),\n    name: 'filterByBranch',\n    options: [{\n      label: 'None',\n      value: 'none'\n    }, ...selectbranchComponent.options]\n  }], [selectbranchComponent]);\n  const singleDetailColumns = useMemo(() => [{\n    Header: intl.formatMessage(messages.sNo),\n    accessor: 'sno',\n    Cell: allData => {\n      var _allData$row;\n\n      return /*#__PURE__*/_jsxDEV(Box, {\n        children: (allData === null || allData === void 0 ? void 0 : (_allData$row = allData.row) === null || _allData$row === void 0 ? void 0 : _allData$row.index) + 1\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 18\n      }, this);\n    }\n  }, {\n    Header: intl.formatMessage(messages.locCode),\n    accessor: 'locationCode'\n  }, {\n    Header: intl.formatMessage(messages.quantity),\n    accessor: 'quantity'\n  }, {\n    Header: intl.formatMessage(messages.price),\n    accessor: 'price',\n    Cell: _ref2 => {\n      let {\n        value\n      } = _ref2;\n      return getMoneyFormat(value);\n    }\n  }, {\n    Header: intl.formatMessage(messages.binLocation),\n    accessor: 'binLocation'\n  }], []);\n  const columns = useMemo(() => [{\n    Header: intl.formatMessage(messages.sNo),\n    accessor: 'sno',\n    Cell: allData => {\n      var _allData$row2;\n\n      return /*#__PURE__*/_jsxDEV(Box, {\n        children: (allData === null || allData === void 0 ? void 0 : (_allData$row2 = allData.row) === null || _allData$row2 === void 0 ? void 0 : _allData$row2.index) + 1\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 18\n      }, this);\n    }\n  }, {\n    Header: intl.formatMessage(messages.partNo),\n    accessor: row => {\n      var _row$part;\n\n      return row === null || row === void 0 ? void 0 : (_row$part = row.part) === null || _row$part === void 0 ? void 0 : _row$part.partNumber;\n    }\n  }, {\n    Header: intl.formatMessage(messages.batchCode),\n    accessor: row => {\n      var _row$batchinventory$;\n\n      return row === null || row === void 0 ? void 0 : (_row$batchinventory$ = row.batchinventory[0]) === null || _row$batchinventory$ === void 0 ? void 0 : _row$batchinventory$.batchCode;\n    }\n  }, {\n    Header: intl.formatMessage(messages.locCode),\n    accessor: row => {\n      var _row$batchinventory$2;\n\n      return (_row$batchinventory$2 = row.batchinventory[0]) === null || _row$batchinventory$2 === void 0 ? void 0 : _row$batchinventory$2.locationCode;\n    }\n  }, {\n    Header: intl.formatMessage(messages.quantity),\n    accessor: 'quantity'\n  }, {\n    Header: intl.formatMessage(messages.price),\n    accessor: 'price',\n    Cell: _ref3 => {\n      let {\n        value\n      } = _ref3;\n      return getMoneyFormat(value);\n    }\n  }, {\n    Header: intl.formatMessage(messages.stockValue),\n    accessor: row => row.quantity * row.price,\n    Cell: _ref4 => {\n      let {\n        value\n      } = _ref4;\n      return getMoneyFormat(value);\n    }\n  }, {\n    Header: 'Actions',\n    accessor: row => ({\n      batchinventory: row.batchinventory,\n      part: row.part\n    }),\n    Cell: _ref5 => {\n      let {\n        value\n      } = _ref5;\n\n      const handleViewDetails = () => {\n        setBatchinventoryList({\n          part: value.part,\n          batchinventory: value.batchinventory\n        });\n        onOpenSingleEntryDetail();\n      };\n\n      return /*#__PURE__*/_jsxDEV(Button, {\n        onClick: handleViewDetails,\n        variant: \"link\",\n        children: \"View Details\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 13\n      }, this);\n    }\n  }], []);\n  const previewColumns = useMemo(() => [{\n    Header: intl.formatMessage(messages.sNo),\n    accessor: 'sno',\n    Cell: allData => {\n      var _allData$row3;\n\n      return /*#__PURE__*/_jsxDEV(Box, {\n        children: (allData === null || allData === void 0 ? void 0 : (_allData$row3 = allData.row) === null || _allData$row3 === void 0 ? void 0 : _allData$row3.index) + 1\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 18\n      }, this);\n    }\n  }, {\n    Header: intl.formatMessage(messages.partNo),\n    accessor: 'partNumber'\n  }, {\n    Header: intl.formatMessage(messages.batchCode),\n    accessor: 'batchCode'\n  }, {\n    Header: intl.formatMessage(messages.locCode),\n    accessor: 'locationCode'\n  }, {\n    Header: intl.formatMessage(messages.quantity),\n    accessor: 'quantity'\n  }, {\n    Header: intl.formatMessage(messages.price),\n    accessor: 'price',\n    Cell: _ref6 => {\n      let {\n        value\n      } = _ref6;\n      return getMoneyFormat(value);\n    }\n  }, {\n    Header: intl.formatMessage(messages.binLocation),\n    accessor: 'binLocation'\n  }], []);\n\n  const handleTableTopChange = async (e, name) => {\n    setTableLoading(true);\n    let value = e.hasOwnProperty('target') ? e.target.value : e;\n\n    if (name === 'filterByBranch') {\n      try {\n        if (typeof e.value === 'string') {\n          await dispatcher(getAllStock({\n            auth,\n            params: { ...inputValues,\n              [name]: typeof value !== 'object' ? value : value.value === 'none' ? '' : value.value\n            }\n          }));\n        } else {\n          var _e$value;\n\n          await dispatcher(getBranchStocks({\n            auth,\n            branchId: e === null || e === void 0 ? void 0 : (_e$value = e.value) === null || _e$value === void 0 ? void 0 : _e$value._id\n          }));\n        }\n\n        setTableLoading(false);\n      } catch (error) {\n        setTableLoading(false);\n      }\n\n      return;\n    }\n\n    try {\n      await dispatcher(getAllStock({\n        auth,\n        params: { ...inputValues,\n          [name]: typeof value !== 'object' ? value : value.value === 'none' ? '' : value.value\n        }\n      }));\n      setTableLoading(false);\n    } catch (error) {\n      setTableLoading(false);\n    }\n  };\n\n  const handleBranchSelect = (e, name) => {\n    setSelectBranch({\n      branch: e.value,\n      name: e.label\n    });\n    setMapingSelectState(prevState => {\n      return prevState.map(item => {\n        if (item.name === 'locationCode') {\n          item.defaultValue = {\n            value: e.value.branchCode,\n            label: e.value.branchCode\n          };\n          item.options = [{\n            value: e.value.branchCode,\n            label: e.value.branchCode\n          }];\n          return item;\n        }\n\n        return item;\n      });\n    });\n  };\n\n  const handleMapping = (e, name) => {\n    setMapKey(prevState => {\n      var _selectedBranch$branc, _selectedBranch$branc2;\n\n      return { ...prevState,\n        [name]: e,\n        locationCode: {\n          label: selectedBranch === null || selectedBranch === void 0 ? void 0 : (_selectedBranch$branc = selectedBranch.branch) === null || _selectedBranch$branc === void 0 ? void 0 : _selectedBranch$branc.branchCode,\n          value: selectedBranch === null || selectedBranch === void 0 ? void 0 : (_selectedBranch$branc2 = selectedBranch.branch) === null || _selectedBranch$branc2 === void 0 ? void 0 : _selectedBranch$branc2.branchCode\n        }\n      };\n    });\n  };\n\n  const handleImportExcelButton = () => {\n    if (!selectedBranch.hasOwnProperty('branch')) {\n      notification({\n        status: 'error',\n        title: 'Branch Not Selected',\n        description: 'Branch must be selected'\n      });\n      return;\n    }\n\n    importExcelRef.current.click();\n  };\n\n  const handleImportChange = async e => {\n    setProcessingImport(true);\n    const rows = await readXlsxFile(e.target.files[0]);\n    const refinedHeader = rows[0].map(e => ({\n      value: e,\n      label: e\n    }));\n    setMapingSelectState(prevState => {\n      return prevState.map(el => {\n        if (el.name === 'locationCode') {\n          return el;\n        }\n\n        el.options = refinedHeader;\n        return el;\n      });\n    });\n    const key = rows[0];\n    const importedData = [];\n    rows.slice(1).forEach(row => {\n      importedData.push(Object.fromEntries(row.map((e, index) => {\n        return [key[index], e];\n      })));\n    });\n    setRawImportedData(importedData);\n    setProcessingImport(false);\n    onMapingModalOpen();\n    e.target.value = null; //reset the file input\n  };\n\n  const handleUploadReview = () => {\n    const uniqueKeys = [...new Set(Object.values({ ...mapKeys\n    }).map(e => e.value))];\n\n    if (uniqueKeys.length !== Object.values({ ...mapKeys\n    }).length) {\n      notification({\n        status: 'error',\n        description: intl.formatMessage(messages.fieldValueMessage)\n      });\n      return;\n    }\n\n    const processedImportData = [...rawImportedData].map((e, index) => {\n      const data = Object.entries({ ...mapKeys\n      }).map(_ref7 => {\n        let [key, value] = _ref7;\n\n        if (key === 'locationCode') {\n          return [key, value.label];\n        }\n\n        return [key, e[value.label]];\n      });\n      return Object.fromEntries(data);\n    });\n    setProcessedImportedData(processedImportData);\n    onStockDataOpen();\n  };\n\n  const handleStockDataUpload = async () => {\n    try {\n      var _selectedBranch$branc3;\n\n      setIsLoading(true);\n      const data = {\n        inventory: [{\n          branchId: selectedBranch === null || selectedBranch === void 0 ? void 0 : (_selectedBranch$branc3 = selectedBranch.branch) === null || _selectedBranch$branc3 === void 0 ? void 0 : _selectedBranch$branc3._id,\n          stocks: processedImportedData\n        }]\n      };\n      await dispatcher(uploadStock({\n        auth,\n        data\n      }));\n      await dispatcher(getAllStock({\n        auth,\n        params: { ...inputValues\n        }\n      }));\n      setIsLoading(false);\n      onClose();\n      onMapingModalClose();\n      onStockDataClose();\n      notification({\n        status: 'success',\n        description: `${intl.formatMessage(messages.stockHasBeenAdded)} ${selectedBranch.name}`\n      });\n    } catch (error) {\n      notification({\n        status: 'error',\n        description: error !== null && error !== void 0 ? error : intl.formatMessage(messages.tryAgain)\n      });\n      setIsLoading(false);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Switch, {\n    children: /*#__PURE__*/_jsxDEV(Route, {\n      exact: true,\n      path: path,\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        minHeight: \"80vh\",\n        children: [/*#__PURE__*/_jsxDEV(Box, {\n          children: /*#__PURE__*/_jsxDEV(Alert, {\n            status: \"info\",\n            children: [/*#__PURE__*/_jsxDEV(AlertIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 590,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(AlertDescription, {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Download a sample file from here \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 592,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n                style: {\n                  fontWeight: 'bold'\n                },\n                href: \"https://docs.google.com/uc?id=1qUvhuzsqNE6CV_GLaK7spluz8qISdhWz&export=download\",\n                download: \"Inventory sample File\",\n                children: \"Download File\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 593,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 591,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 589,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 588,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ModifiedTableTop, {\n          inputData: inputData,\n          onChange: handleTableTopChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 604,\n          columnNumber: 11\n        }, this), isDistributor && /*#__PURE__*/_jsxDEV(Box, {\n          display: \"flex\",\n          justifyContent: \"flex-end\",\n          mb: 6,\n          width: \"100%\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            accept: \".xlsx\",\n            ref: importExcelRef,\n            type: \"file\",\n            onChange: handleImportChange,\n            style: {\n              display: 'none'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 610,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"normal\",\n            onClick: onOpen,\n            children: intl.formatMessage(messages.bulkUpload)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 617,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 609,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(DynamicTable, {\n          columns: columns,\n          data: allStock,\n          fetchData: () => console.log('...fetching'),\n          skipPageReset: true,\n          loading: tableLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 623,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(SimpleModal, {\n          onOk: handleImportExcelButton,\n          isLoading: processingImport,\n          onClose: onClose,\n          isOpen: isOpen,\n          title: intl.formatMessage(messages.selectBranch),\n          okText: intl.formatMessage(messages.importStock),\n          children: generateInput(selectbranchComponent, handleBranchSelect)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 630,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(SimpleModal, {\n          size: \"xl\",\n          onOk: handleUploadReview,\n          isLoading: false,\n          onClose: onMapingModalClose,\n          isOpen: mapingModalOpen,\n          title: intl.formatMessage(messages.mapFields),\n          okText: intl.formatMessage(messages.next),\n          children: /*#__PURE__*/_jsxDEV(Box, {\n            display: \"flex\",\n            flexWrap: \"wrap\",\n            justifyContent: \"space-between\",\n            children: mappingSelectState.map(e => /*#__PURE__*/_jsxDEV(Box, {\n              width: \"49%\",\n              children: generateInput(e, handleMapping)\n            }, e.name, false, {\n              fileName: _jsxFileName,\n              lineNumber: 652,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 650,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 641,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(SimpleModal, {\n          size: \"2.5xl\",\n          onOk: handleStockDataUpload,\n          isLoading: isLoading,\n          onClose: onStockDataClose,\n          isOpen: stockDataOpen,\n          title: `${intl.formatMessage(messages.stockData)} - ${selectedBranch === null || selectedBranch === void 0 ? void 0 : (_selectedBranch$branc4 = selectedBranch.branch) === null || _selectedBranch$branc4 === void 0 ? void 0 : _selectedBranch$branc4.branchName}`,\n          okText: intl.formatMessage(messages.uploadStock),\n          children: /*#__PURE__*/_jsxDEV(Box, {\n            height: \"100%\",\n            children: /*#__PURE__*/_jsxDEV(DynamicTable, {\n              columns: previewColumns,\n              data: processedImportedData,\n              fetchData: () => console.log('...fetching'),\n              skipPageReset: true,\n              loading: tableLoading,\n              hidePagination: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 670,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 669,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 658,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(SimpleModal, {\n          onClose: onCloseSingleEntryDetail,\n          isOpen: openSingleEntryDetail,\n          title: `${batchinventoryList.part.partName} - ${batchinventoryList.part.partNumber}`,\n          hidefooter: true,\n          size: \"2.5xl\",\n          children: /*#__PURE__*/_jsxDEV(Box, {\n            m: 5,\n            children: /*#__PURE__*/_jsxDEV(DynamicTable, {\n              columns: singleDetailColumns,\n              data: batchinventoryList.batchinventory,\n              fetchData: () => console.log('...fetching'),\n              skipPageReset: true,\n              loading: tableLoading,\n              hidePagination: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 688,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 687,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 680,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 587,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 586,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 585,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Inventory, \"8SG2YGzh26+/SAupqaDtgZfddMU=\", false, function () {\n  return [useIntl, useSelector, useSelector, useDispatch, useRouteMatch, useDisclosure, useDisclosure, useDisclosure, useDisclosure, useSelector];\n});\n\n_c = Inventory;\nexport default _c2 = withToast(Inventory);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Inventory\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["C:/Users/Acer/Desktop/Work/garaaz-distributor/src/containers/Inventory/index.js"],"names":["React","useMemo","useState","useRef","useEffect","useIntl","Box","Button","Link","useDisclosure","Alert","AlertIcon","AlertDescription","readXlsxFile","useSelector","useDispatch","moment","useRouteMatch","Switch","Route","ReactLink","DynamicTable","ModifiedTableTop","generateInput","SimpleModal","withToast","getMoneyFormat","getCamelCase","selectGlobalState","messages","getAllStock","selectInventory","uploadStock","getBranchStocks","selectBranch","title","type","placeholder","name","fullWidth","options","mapSelect","isDisabled","defaultValue","value","label","Inventory","notification","inputValues","setInputValue","start","format","end","startOf","intl","importExcelRef","isLoading","setIsLoading","allStock","batchinventoryList","setBatchinventoryList","part","batchinventory","auth","state","dispatcher","url","path","tableLoading","setTableLoading","isOpen","onOpen","onClose","mapingModalOpen","onMapingModalOpen","onMapingModalClose","stockDataOpen","onStockDataOpen","onStockDataClose","openSingleEntryDetail","onOpenSingleEntryDetail","onCloseSingleEntryDetail","selectbranchComponent","setSelectbranchComponent","selectedBranch","setSelectBranch","mappingSelectState","setMapingSelectState","processingImport","setProcessingImport","rawImportedData","setRawImportedData","mapKeys","setMapKey","processedImportedData","setProcessedImportedData","branches","isDistributor","params","refinedBranch","map","e","branchName","prev","error","inputData","formatMessage","filterByBranch","singleDetailColumns","Header","sNo","accessor","Cell","allData","row","index","locCode","quantity","price","binLocation","columns","partNo","partNumber","batchCode","locationCode","stockValue","handleViewDetails","previewColumns","handleTableTopChange","hasOwnProperty","target","branchId","_id","handleBranchSelect","branch","prevState","item","branchCode","handleMapping","handleImportExcelButton","status","description","current","click","handleImportChange","rows","files","refinedHeader","el","key","importedData","slice","forEach","push","Object","fromEntries","handleUploadReview","uniqueKeys","Set","values","length","fieldValueMessage","processedImportData","data","entries","handleStockDataUpload","inventory","stocks","stockHasBeenAdded","tryAgain","fontWeight","display","bulkUpload","console","log","importStock","mapFields","next","stockData","partName"],"mappings":"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","sourcesContent":["import React, { useMemo, useState, useRef, useEffect } from 'react';\r\n\r\nimport { useIntl } from 'react-intl';\r\nimport {\r\n  Box,\r\n  Button,\r\n  Link,\r\n  useDisclosure,\r\n  Alert,\r\n  AlertIcon,\r\n  AlertDescription,\r\n} from '@chakra-ui/react';\r\nimport readXlsxFile from 'read-excel-file';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport moment from 'moment';\r\nimport {\r\n  useRouteMatch,\r\n  Switch,\r\n  Route,\r\n  Link as ReactLink,\r\n} from 'react-router-dom';\r\n\r\nimport DynamicTable from '../../components/DynamicTable';\r\nimport ModifiedTableTop, {\r\n  generateInput,\r\n} from '../../components/TableTop/ModifiedTableTop';\r\nimport SimpleModal from '../../components/Modal';\r\n\r\nimport withToast from '../../HOCs/withToast';\r\nimport getMoneyFormat from '../../utils/getMoneyFormat';\r\nimport getCamelCase from '../../utils/getCamelCase';\r\nimport { selectGlobalState } from '../../globalSlice';\r\n\r\nimport messages from './messages';\r\nimport {\r\n  getAllStock,\r\n  selectInventory,\r\n  uploadStock,\r\n  getBranchStocks,\r\n} from './slice';\r\n\r\nconst selectBranch = {\r\n  title: 'Select Branch',\r\n  type: 'select',\r\n  placeholder: 'Select option',\r\n  name: 'groupBy',\r\n  fullWidth: true,\r\n  options: [],\r\n};\r\n\r\nconst mapSelect = [\r\n  {\r\n    title: 'Location Code',\r\n    type: 'select',\r\n    placeholder: 'Select option',\r\n    name: 'locationCode',\r\n    isDisabled: false,\r\n    fullWidth: true,\r\n    defaultValue: {\r\n      value: 'Loc Code',\r\n      label: 'Loc Code',\r\n    },\r\n    options: [\r\n      {\r\n        value: 'none',\r\n        label: 'None',\r\n      },\r\n      {\r\n        value: 'Loc Code',\r\n        label: 'Loc Code',\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    title: 'Part Number',\r\n    type: 'select',\r\n    placeholder: 'Select option',\r\n    name: 'partNumber',\r\n    fullWidth: true,\r\n    options: [\r\n      {\r\n        value: 'none',\r\n        label: 'None',\r\n      },\r\n      {\r\n        value: 'Loc Code',\r\n        label: 'Loc Code',\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    title: 'Batch Code',\r\n    type: 'select',\r\n    placeholder: 'Select option',\r\n    name: 'batchCode',\r\n    fullWidth: true,\r\n    options: [\r\n      {\r\n        value: 'none',\r\n        label: 'None',\r\n      },\r\n      {\r\n        value: 'Loc Code',\r\n        label: 'Loc Code',\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    title: 'Quantity',\r\n    type: 'select',\r\n    placeholder: 'Select option',\r\n    name: 'quantity',\r\n    fullWidth: true,\r\n    options: [\r\n      {\r\n        value: 'none',\r\n        label: 'None',\r\n      },\r\n      {\r\n        value: 'Loc Code',\r\n        label: 'Loc Code',\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    title: 'Price',\r\n    type: 'select',\r\n    placeholder: 'Select option',\r\n    name: 'price',\r\n    fullWidth: true,\r\n    options: [\r\n      {\r\n        value: 'none',\r\n        label: 'None',\r\n      },\r\n      {\r\n        value: 'Loc Code',\r\n        label: 'Loc Code',\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    title: 'Bin Location',\r\n    type: 'select',\r\n    placeholder: 'Select option',\r\n    name: 'binLocation',\r\n    fullWidth: true,\r\n    options: [\r\n      {\r\n        value: 'none',\r\n        label: 'None',\r\n      },\r\n      {\r\n        value: 'Loc Code',\r\n        label: 'Loc Code',\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\nconst Inventory = ({ notification }) => {\r\n  const [inputValues, setInputValue] = useState({\r\n    start: moment().format('DD-MM-YYYY'),\r\n    end: moment().startOf('month').format('DD-MM-YYYY'),\r\n  });\r\n  const intl = useIntl();\r\n  const importExcelRef = useRef();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const { allStock } = useSelector(selectInventory);\r\n  const [batchinventoryList, setBatchinventoryList] = useState({\r\n    part: {},\r\n    batchinventory: [],\r\n  });\r\n  const auth = useSelector((state) => state.auth);\r\n  const dispatcher = useDispatch();\r\n  const { url, path } = useRouteMatch();\r\n  const [tableLoading, setTableLoading] = useState(false);\r\n  const { isOpen, onOpen, onClose } = useDisclosure();\r\n  const {\r\n    isOpen: mapingModalOpen,\r\n    onOpen: onMapingModalOpen,\r\n    onClose: onMapingModalClose,\r\n  } = useDisclosure();\r\n  const {\r\n    isOpen: stockDataOpen,\r\n    onOpen: onStockDataOpen,\r\n    onClose: onStockDataClose,\r\n  } = useDisclosure();\r\n  const {\r\n    isOpen: openSingleEntryDetail,\r\n    onOpen: onOpenSingleEntryDetail,\r\n    onClose: onCloseSingleEntryDetail,\r\n  } = useDisclosure();\r\n  const [selectbranchComponent, setSelectbranchComponent] =\r\n    useState(selectBranch);\r\n  const [selectedBranch, setSelectBranch] = useState({});\r\n  const [mappingSelectState, setMapingSelectState] = useState(mapSelect);\r\n  const [processingImport, setProcessingImport] = useState(false);\r\n  const [rawImportedData, setRawImportedData] = useState([]);\r\n  const [mapKeys, setMapKey] = useState({});\r\n  const [processedImportedData, setProcessedImportedData] = useState([]);\r\n  const { branches, isDistributor } = useSelector(selectGlobalState);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        await dispatcher(getAllStock({ auth, params: { ...inputValues } }));\r\n\r\n        const refinedBranch = [...branches].map((e) => {\r\n          return { value: e, label: e.branchName };\r\n        });\r\n\r\n        setSelectbranchComponent((prev) => ({\r\n          ...prev,\r\n          options: refinedBranch,\r\n        }));\r\n      } catch (error) {}\r\n    })();\r\n  }, [branches]);\r\n\r\n  const inputData = useMemo(\r\n    () => [\r\n      /* {\r\n        title: intl.formatMessage(messages.inventoryDetailSearch),\r\n        type: 'text',\r\n        placeholder: '',\r\n        name: 'searchAccount',\r\n      },\r\n      {\r\n        title: intl.formatMessage(messages.groupBy),\r\n        type: 'select',\r\n        placeholder: 'Select option',\r\n        name: 'groupBy',\r\n        options: [\r\n          {\r\n            value: 'none',\r\n            label: 'None',\r\n          },\r\n          {\r\n            value: 'Loc Code',\r\n            label: intl.formatMessage(messages.locCode),\r\n          },\r\n        ],\r\n      }, */\r\n      {\r\n        title: intl.formatMessage(messages.filterByBranch),\r\n        type: 'select',\r\n        placeholder: intl.formatMessage(messages.selectBranch),\r\n        name: 'filterByBranch',\r\n        options: [\r\n          { label: 'None', value: 'none' },\r\n          ...selectbranchComponent.options,\r\n        ],\r\n      },\r\n    ],\r\n    [selectbranchComponent],\r\n  );\r\n\r\n  const singleDetailColumns = useMemo(\r\n    () => [\r\n      {\r\n        Header: intl.formatMessage(messages.sNo),\r\n        accessor: 'sno',\r\n        Cell: (allData) => {\r\n          return <Box>{allData?.row?.index + 1}</Box>;\r\n        },\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.locCode),\r\n        accessor: 'locationCode',\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.quantity),\r\n        accessor: 'quantity',\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.price),\r\n        accessor: 'price',\r\n        Cell: ({ value }) => getMoneyFormat(value),\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.binLocation),\r\n        accessor: 'binLocation',\r\n      },\r\n    ],\r\n    [],\r\n  );\r\n\r\n  const columns = useMemo(\r\n    () => [\r\n      {\r\n        Header: intl.formatMessage(messages.sNo),\r\n        accessor: 'sno',\r\n        Cell: (allData) => {\r\n          return <Box>{allData?.row?.index + 1}</Box>;\r\n        },\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.partNo),\r\n        accessor: (row) => row?.part?.partNumber,\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.batchCode),\r\n        accessor: (row) => row?.batchinventory[0]?.batchCode,\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.locCode),\r\n        accessor: (row) => row.batchinventory[0]?.locationCode,\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.quantity),\r\n        accessor: 'quantity',\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.price),\r\n        accessor: 'price',\r\n        Cell: ({ value }) => getMoneyFormat(value),\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.stockValue),\r\n        accessor: (row) => row.quantity * row.price,\r\n        Cell: ({ value }) => getMoneyFormat(value),\r\n      },\r\n      {\r\n        Header: 'Actions',\r\n        accessor: (row) => ({\r\n          batchinventory: row.batchinventory,\r\n          part: row.part,\r\n        }),\r\n        Cell: ({ value }) => {\r\n          const handleViewDetails = () => {\r\n            setBatchinventoryList({\r\n              part: value.part,\r\n              batchinventory: value.batchinventory,\r\n            });\r\n            onOpenSingleEntryDetail();\r\n          };\r\n          return (\r\n            <Button onClick={handleViewDetails} variant='link'>\r\n              View Details\r\n            </Button>\r\n          );\r\n        },\r\n      },\r\n    ],\r\n    [],\r\n  );\r\n\r\n  const previewColumns = useMemo(\r\n    () => [\r\n      {\r\n        Header: intl.formatMessage(messages.sNo),\r\n        accessor: 'sno',\r\n        Cell: (allData) => {\r\n          return <Box>{allData?.row?.index + 1}</Box>;\r\n        },\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.partNo),\r\n        accessor: 'partNumber',\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.batchCode),\r\n        accessor: 'batchCode',\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.locCode),\r\n        accessor: 'locationCode',\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.quantity),\r\n        accessor: 'quantity',\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.price),\r\n        accessor: 'price',\r\n        Cell: ({ value }) => getMoneyFormat(value),\r\n      },\r\n      {\r\n        Header: intl.formatMessage(messages.binLocation),\r\n        accessor: 'binLocation',\r\n      },\r\n    ],\r\n    [],\r\n  );\r\n\r\n  const handleTableTopChange = async (e, name) => {\r\n    setTableLoading(true);\r\n    let value = e.hasOwnProperty('target') ? e.target.value : e;\r\n\r\n    if (name === 'filterByBranch') {\r\n      try {\r\n        if (typeof e.value === 'string') {\r\n          await dispatcher(\r\n            getAllStock({\r\n              auth,\r\n              params: {\r\n                ...inputValues,\r\n                [name]:\r\n                  typeof value !== 'object'\r\n                    ? value\r\n                    : value.value === 'none'\r\n                    ? ''\r\n                    : value.value,\r\n              },\r\n            }),\r\n          );\r\n        } else {\r\n          await dispatcher(getBranchStocks({ auth, branchId: e?.value?._id }));\r\n        }\r\n\r\n        setTableLoading(false);\r\n      } catch (error) {\r\n        setTableLoading(false);\r\n      }\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await dispatcher(\r\n        getAllStock({\r\n          auth,\r\n          params: {\r\n            ...inputValues,\r\n            [name]:\r\n              typeof value !== 'object'\r\n                ? value\r\n                : value.value === 'none'\r\n                ? ''\r\n                : value.value,\r\n          },\r\n        }),\r\n      );\r\n\r\n      setTableLoading(false);\r\n    } catch (error) {\r\n      setTableLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleBranchSelect = (e, name) => {\r\n    setSelectBranch({ branch: e.value, name: e.label });\r\n\r\n    setMapingSelectState((prevState) => {\r\n      return prevState.map((item) => {\r\n        if (item.name === 'locationCode') {\r\n          item.defaultValue = {\r\n            value: e.value.branchCode,\r\n            label: e.value.branchCode,\r\n          };\r\n          item.options = [\r\n            { value: e.value.branchCode, label: e.value.branchCode },\r\n          ];\r\n          return item;\r\n        }\r\n        return item;\r\n      });\r\n    });\r\n  };\r\n\r\n  const handleMapping = (e, name) => {\r\n    setMapKey((prevState) => ({\r\n      ...prevState,\r\n      [name]: e,\r\n      locationCode: {\r\n        label: selectedBranch?.branch?.branchCode,\r\n        value: selectedBranch?.branch?.branchCode,\r\n      },\r\n    }));\r\n  };\r\n\r\n  const handleImportExcelButton = () => {\r\n    if (!selectedBranch.hasOwnProperty('branch')) {\r\n      notification({\r\n        status: 'error',\r\n        title: 'Branch Not Selected',\r\n        description: 'Branch must be selected',\r\n      });\r\n      return;\r\n    }\r\n    importExcelRef.current.click();\r\n  };\r\n\r\n  const handleImportChange = async (e) => {\r\n    setProcessingImport(true);\r\n    const rows = await readXlsxFile(e.target.files[0]);\r\n\r\n    const refinedHeader = rows[0].map((e) => ({\r\n      value: e,\r\n      label: e,\r\n    }));\r\n\r\n    setMapingSelectState((prevState) => {\r\n      return prevState.map((el) => {\r\n        if (el.name === 'locationCode') {\r\n          return el;\r\n        }\r\n        el.options = refinedHeader;\r\n        return el;\r\n      });\r\n    });\r\n\r\n    const key = rows[0];\r\n\r\n    const importedData = [];\r\n\r\n    rows.slice(1).forEach((row) => {\r\n      importedData.push(\r\n        Object.fromEntries(\r\n          row.map((e, index) => {\r\n            return [key[index], e];\r\n          }),\r\n        ),\r\n      );\r\n    });\r\n\r\n    setRawImportedData(importedData);\r\n\r\n    setProcessingImport(false);\r\n    onMapingModalOpen();\r\n\r\n    e.target.value = null; //reset the file input\r\n  };\r\n\r\n  const handleUploadReview = () => {\r\n    const uniqueKeys = [\r\n      ...new Set(Object.values({ ...mapKeys }).map((e) => e.value)),\r\n    ];\r\n    if (uniqueKeys.length !== Object.values({ ...mapKeys }).length) {\r\n      notification({\r\n        status: 'error',\r\n        description: intl.formatMessage(messages.fieldValueMessage),\r\n      });\r\n      return;\r\n    }\r\n\r\n    const processedImportData = [...rawImportedData].map((e, index) => {\r\n      const data = Object.entries({ ...mapKeys }).map(([key, value]) => {\r\n        if (key === 'locationCode') {\r\n          return [key, value.label];\r\n        }\r\n\r\n        return [key, e[value.label]];\r\n      });\r\n      return Object.fromEntries(data);\r\n    });\r\n\r\n    setProcessedImportedData(processedImportData);\r\n    onStockDataOpen();\r\n  };\r\n\r\n  const handleStockDataUpload = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const data = {\r\n        inventory: [\r\n          {\r\n            branchId: selectedBranch?.branch?._id,\r\n            stocks: processedImportedData,\r\n          },\r\n        ],\r\n      };\r\n      await dispatcher(uploadStock({ auth, data }));\r\n      await dispatcher(getAllStock({ auth, params: { ...inputValues } }));\r\n      setIsLoading(false);\r\n      onClose();\r\n      onMapingModalClose();\r\n      onStockDataClose();\r\n      notification({\r\n        status: 'success',\r\n        description: `${intl.formatMessage(messages.stockHasBeenAdded)} ${\r\n          selectedBranch.name\r\n        }`,\r\n      });\r\n    } catch (error) {\r\n      notification({\r\n        status: 'error',\r\n        description: error ?? intl.formatMessage(messages.tryAgain),\r\n      });\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Switch>\r\n      <Route exact path={path}>\r\n        <Box minHeight='80vh'>\r\n          <Box>\r\n            <Alert status='info'>\r\n              <AlertIcon />\r\n              <AlertDescription>\r\n                <label>Download a sample file from here </label>\r\n                <a\r\n                  style={{ fontWeight: 'bold' }}\r\n                  href='https://docs.google.com/uc?id=1qUvhuzsqNE6CV_GLaK7spluz8qISdhWz&export=download'\r\n                  download='Inventory sample File'\r\n                >\r\n                  Download File\r\n                </a>\r\n              </AlertDescription>\r\n            </Alert>\r\n          </Box>\r\n\r\n          <ModifiedTableTop\r\n            inputData={inputData}\r\n            onChange={handleTableTopChange}\r\n          />\r\n          {isDistributor && (\r\n            <Box display='flex' justifyContent='flex-end' mb={6} width='100%'>\r\n              <input\r\n                accept='.xlsx'\r\n                ref={importExcelRef}\r\n                type='file'\r\n                onChange={handleImportChange}\r\n                style={{ display: 'none' }}\r\n              />\r\n              <Button variant='normal' onClick={onOpen}>\r\n                {intl.formatMessage(messages.bulkUpload)}\r\n              </Button>\r\n            </Box>\r\n          )}\r\n\r\n          <DynamicTable\r\n            columns={columns}\r\n            data={allStock}\r\n            fetchData={() => console.log('...fetching')}\r\n            skipPageReset={true}\r\n            loading={tableLoading}\r\n          />\r\n          <SimpleModal\r\n            onOk={handleImportExcelButton}\r\n            isLoading={processingImport}\r\n            onClose={onClose}\r\n            isOpen={isOpen}\r\n            title={intl.formatMessage(messages.selectBranch)}\r\n            okText={intl.formatMessage(messages.importStock)}\r\n          >\r\n            {generateInput(selectbranchComponent, handleBranchSelect)}\r\n          </SimpleModal>\r\n\r\n          <SimpleModal\r\n            size='xl'\r\n            onOk={handleUploadReview}\r\n            isLoading={false}\r\n            onClose={onMapingModalClose}\r\n            isOpen={mapingModalOpen}\r\n            title={intl.formatMessage(messages.mapFields)}\r\n            okText={intl.formatMessage(messages.next)}\r\n          >\r\n            <Box display='flex' flexWrap='wrap' justifyContent='space-between'>\r\n              {mappingSelectState.map((e) => (\r\n                <Box key={e.name} width='49%'>\r\n                  {generateInput(e, handleMapping)}\r\n                </Box>\r\n              ))}\r\n            </Box>\r\n          </SimpleModal>\r\n          <SimpleModal\r\n            size='2.5xl'\r\n            onOk={handleStockDataUpload}\r\n            isLoading={isLoading}\r\n            onClose={onStockDataClose}\r\n            isOpen={stockDataOpen}\r\n            title={`${intl.formatMessage(messages.stockData)} - ${\r\n              selectedBranch?.branch?.branchName\r\n            }`}\r\n            okText={intl.formatMessage(messages.uploadStock)}\r\n          >\r\n            <Box height='100%'>\r\n              <DynamicTable\r\n                columns={previewColumns}\r\n                data={processedImportedData}\r\n                fetchData={() => console.log('...fetching')}\r\n                skipPageReset={true}\r\n                loading={tableLoading}\r\n                hidePagination={true}\r\n              />\r\n            </Box>\r\n          </SimpleModal>\r\n          <SimpleModal\r\n            onClose={onCloseSingleEntryDetail}\r\n            isOpen={openSingleEntryDetail}\r\n            title={`${batchinventoryList.part.partName} - ${batchinventoryList.part.partNumber}`}\r\n            hidefooter\r\n            size='2.5xl'\r\n          >\r\n            <Box m={5}>\r\n              <DynamicTable\r\n                columns={singleDetailColumns}\r\n                data={batchinventoryList.batchinventory}\r\n                fetchData={() => console.log('...fetching')}\r\n                skipPageReset={true}\r\n                loading={tableLoading}\r\n                hidePagination={true}\r\n              />\r\n            </Box>\r\n          </SimpleModal>\r\n        </Box>\r\n      </Route>\r\n    </Switch>\r\n  );\r\n};\r\n\r\nexport default withToast(Inventory);\r\n"]},"metadata":{},"sourceType":"module"}