{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Acer\\\\Desktop\\\\Work\\\\garaaz-distributor\\\\src\\\\components\\\\WorkShopAddition\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { useIntl } from 'react-intl';\nimport { Button } from '@chakra-ui/button';\nimport { Stepper, Step } from 'react-form-stepper';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useParams } from \"react-router-dom\";\nimport toast from 'react-hot-toast';\nimport { useHistory } from 'react-router-dom';\nimport Layout from '../../containers/Layout';\nimport LocationDetailsForm from '../LocationDetailsForm';\nimport WorkshopContactForm from '../WorkshopContactForm';\nimport PaymentTermsForm from '../PaymentDetailForm';\nimport WorkShopDetailsForm from '../WorkShopDetailsForm';\nimport messages from './messages';\nimport { addWorkShop, editWorkshop, getWorkShop } from './action';\nimport Label from '../../utils/stepperLabel';\nimport { stepperObject } from './constants';\nimport { getDistributorInfo } from '../../containers/DistributerInfo/actions';\nimport { isUndefined } from 'lodash';\nimport { UseOnboardContext } from '../../App';\nimport { getWorkshops, selectGlobalState } from '../../globalSlice';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst WorkshopAddition = () => {\n  _s();\n\n  const {\n    updateOnboard\n  } = UseOnboardContext();\n  const history = useHistory();\n  const {\n    workshopId: workshopid\n  } = useParams();\n  const intl = useIntl();\n  const [activeStep, setActiveStep] = useState(1);\n  const [currentWorkshop, setCurrentWorkshop] = useState({});\n  const auth = useSelector(state => state.auth);\n  const [distributorId, setDistributorId] = useState('');\n  const [incomplete, setIncomplete] = useState({\n    workshopDetails: false,\n    location: false,\n    contact: false,\n    payment: false\n  });\n  const {\n    distributor\n  } = useSelector(selectGlobalState);\n  const {\n    pathname\n  } = history.location;\n  const dispatcher = useDispatch();\n\n  const getWorkshopDetails = async distriId => {\n    const data = await getWorkShop(auth, distriId, workshopid);\n    setCurrentWorkshop(data);\n  };\n  /*  const distributorInfo = async () => {\r\n     const data = await getDistributorInfo(auth)\r\n     setDistributorId(data._id)\r\n     if (pathname !== '/workshop/add') {\r\n       getWorkshopDetails(data._id);\r\n     }\r\n   } */\n\n\n  useEffect(() => {\n    //distributorInfo()\n    if (pathname !== '/workshop/add') {\n      getWorkshopDetails(distributor._id);\n    }\n  }, [distributor]);\n  const {\n    _id: workshopId,\n    workshopName,\n    pinCode,\n    mobileNumber,\n    paymentTerms\n  } = currentWorkshop;\n  useEffect(() => {\n    if (isUndefined(workshopName) && activeStep > 1) {\n      setIncomplete({ ...incomplete,\n        workshopDetails: true\n      });\n    }\n\n    if (isUndefined(pinCode) && activeStep > 2) {\n      setIncomplete({ ...incomplete,\n        location: true\n      });\n    }\n\n    if (isUndefined(mobileNumber) && activeStep > 3) {\n      setIncomplete({ ...incomplete,\n        contact: true\n      });\n    }\n\n    if (isUndefined(paymentTerms) && activeStep != 4) {\n      setIncomplete({ ...incomplete,\n        payment: true\n      });\n    }\n  }, [currentWorkshop, activeStep]);\n\n  const renderSteps = () => {\n    return stepperObject.map((step, index) => /*#__PURE__*/_jsxDEV(Step, {\n      label: /*#__PURE__*/_jsxDEV(Label, {\n        title: intl.formatMessage(step.label),\n        isComplete: workshopId\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 16\n      }, this),\n      onClick: () => setActiveStep(index + 1),\n      completed: !isUndefined(currentWorkshop[step.isCompleted]) && currentWorkshop[step.isCompleted] !== \"\"\n    }, step.label, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this));\n  };\n\n  const workshopEdit = async update => {\n    try {\n      await editWorkshop(auth, update, distributor._id, workshopid);\n      await getWorkshopDetails(distributor._id);\n      toast(intl.formatMessage(messages.workshopDetailsSaveSuccess));\n    } catch (error) {\n      toast(intl.formatMessage(messages.somethingWentWrong));\n    }\n  };\n\n  const handelFormSumbit = async (Data, stepNumber) => {\n    if (currentWorkshop._id) workshopEdit(Data);else switch (stepNumber) {\n      case 1:\n      case 2:\n      case 3:\n        setCurrentWorkshop({ ...currentWorkshop,\n          ...Data\n        });\n        setActiveStep(stepNumber + 1);\n        break;\n\n      default:\n        setCurrentWorkshop({ ...currentWorkshop,\n          ...Data\n        });\n\n        try {\n          if (isUndefined(currentWorkshop.mobileNumber)) {\n            setActiveStep(3);\n          } else if (isUndefined(currentWorkshop.pinCode)) {\n            setActiveStep(2);\n          } else if (isUndefined(currentWorkshop.name)) {\n            setActiveStep(1);\n          } else {\n            await addWorkShop(auth, { ...currentWorkshop,\n              ...Data\n            }, distributor._id);\n            dispatcher(getWorkshops({\n              auth,\n              distributorId: distributor._id\n            }));\n            history.push('/workshops');\n\n            if (localStorage.onboard) {\n              localStorage.removeItem('onboard');\n              updateOnboard('');\n            }\n          }\n        } catch (error) {\n          if (error.response) {\n            toast(error.response.data.errorMsg);\n          } else {\n            toast(intl.formatMessage(messages.somethingWentWrong));\n          }\n        }\n\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-0 p-6 pb-0\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center flex\",\n        style: {\n          height: \"12.5%\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            alignSelf: \"flex-end\",\n            display: activeStep === 1 ? \"block\" : \"none\",\n            marginLeft: \"auto\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"bulkAdd\",\n            size: \"md\",\n            onClick: () => history.push('/workshop/add/bulk'),\n            children: intl.formatMessage(messages.bulkUpload)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full mb-0\",\n        children: /*#__PURE__*/_jsxDEV(Stepper, {\n          activeStep: activeStep,\n          styleConfig: {\n            completedBgColor: \"#008000\",\n            activeBgColor: \"#1e293b\"\n          },\n          style: {\n            paddingBottom: \"4px\"\n          },\n          children: renderSteps()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-auto px-6 pb-6 pt-0\",\n        children: [activeStep === 1 && /*#__PURE__*/_jsxDEV(WorkShopDetailsForm, {\n          currentWorkshop: currentWorkshop,\n          onFormSubmit: handelFormSumbit\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 15\n        }, this), activeStep === 2 && /*#__PURE__*/_jsxDEV(LocationDetailsForm, {\n          currentWorkshop: currentWorkshop,\n          onFormSubmit: handelFormSumbit\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 15\n        }, this), activeStep === 3 && /*#__PURE__*/_jsxDEV(WorkshopContactForm, {\n          currentWorkshop: currentWorkshop,\n          onFormSubmit: handelFormSumbit\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 15\n        }, this), activeStep === 4 && /*#__PURE__*/_jsxDEV(PaymentTermsForm, {\n          currentWorkshop: currentWorkshop,\n          onFormSubmit: handelFormSumbit\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n};\n\n_s(WorkshopAddition, \"dOTcchG2nfniUONgMeU8RqOi2xk=\", false, function () {\n  return [useHistory, useParams, useIntl, useSelector, useSelector, useDispatch];\n});\n\n_c = WorkshopAddition;\nexport default WorkshopAddition;\n\nvar _c;\n\n$RefreshReg$(_c, \"WorkshopAddition\");","map":{"version":3,"sources":["C:/Users/Acer/Desktop/Work/garaaz-distributor/src/components/WorkShopAddition/index.js"],"names":["React","useState","useEffect","useIntl","Button","Stepper","Step","useDispatch","useSelector","useParams","toast","useHistory","Layout","LocationDetailsForm","WorkshopContactForm","PaymentTermsForm","WorkShopDetailsForm","messages","addWorkShop","editWorkshop","getWorkShop","Label","stepperObject","getDistributorInfo","isUndefined","UseOnboardContext","getWorkshops","selectGlobalState","WorkshopAddition","updateOnboard","history","workshopId","workshopid","intl","activeStep","setActiveStep","currentWorkshop","setCurrentWorkshop","auth","state","distributorId","setDistributorId","incomplete","setIncomplete","workshopDetails","location","contact","payment","distributor","pathname","dispatcher","getWorkshopDetails","distriId","data","_id","workshopName","pinCode","mobileNumber","paymentTerms","renderSteps","map","step","index","formatMessage","label","isCompleted","workshopEdit","update","workshopDetailsSaveSuccess","error","somethingWentWrong","handelFormSumbit","Data","stepNumber","name","push","localStorage","onboard","removeItem","response","errorMsg","height","alignSelf","display","marginLeft","bulkUpload","completedBgColor","activeBgColor","paddingBottom"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useIntl } from 'react-intl';\r\nimport { Button } from '@chakra-ui/button';\r\nimport { Stepper, Step } from 'react-form-stepper';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useParams } from \"react-router-dom\";\r\nimport toast from 'react-hot-toast';\r\nimport { useHistory } from 'react-router-dom';\r\nimport Layout from '../../containers/Layout';\r\nimport LocationDetailsForm from '../LocationDetailsForm';\r\nimport WorkshopContactForm from '../WorkshopContactForm';\r\nimport PaymentTermsForm from '../PaymentDetailForm';\r\nimport WorkShopDetailsForm from '../WorkShopDetailsForm';\r\nimport messages from './messages';\r\nimport { addWorkShop, editWorkshop, getWorkShop } from './action'\r\nimport Label from '../../utils/stepperLabel';\r\nimport { stepperObject } from './constants';\r\nimport { getDistributorInfo } from '../../containers/DistributerInfo/actions';\r\nimport { isUndefined } from 'lodash';\r\nimport { UseOnboardContext } from '../../App';\r\nimport { getWorkshops , selectGlobalState} from '../../globalSlice';\r\n\r\nconst WorkshopAddition = () => {\r\n  const { updateOnboard } = UseOnboardContext();\r\n  const history = useHistory();\r\n  const { workshopId: workshopid } = useParams();\r\n  const intl = useIntl();\r\n  const [activeStep, setActiveStep] = useState(1);\r\n  const [currentWorkshop, setCurrentWorkshop] = useState({});\r\n  const auth = useSelector(state => state.auth);\r\n  const [distributorId, setDistributorId] = useState('')\r\n  const [incomplete, setIncomplete] = useState({\r\n    workshopDetails: false,\r\n    location: false,\r\n    contact: false,\r\n    payment: false,\r\n  });\r\n  const { distributor } = useSelector(selectGlobalState);\r\n  const { pathname } = history.location\r\n\r\n\r\n  const dispatcher = useDispatch();\r\n  \r\n  const getWorkshopDetails = async (distriId) => {\r\n    const data = await getWorkShop(auth, distriId, workshopid)\r\n    setCurrentWorkshop(data)\r\n  }\r\n /*  const distributorInfo = async () => {\r\n    const data = await getDistributorInfo(auth)\r\n    setDistributorId(data._id)\r\n    if (pathname !== '/workshop/add') {\r\n      getWorkshopDetails(data._id);\r\n    }\r\n  } */\r\n  useEffect(() => {\r\n    //distributorInfo()\r\n    if (pathname !== '/workshop/add') {\r\n      getWorkshopDetails(distributor._id)\r\n    }\r\n  }, [distributor])\r\n\r\n  const { _id: workshopId, workshopName, pinCode, mobileNumber, paymentTerms } = currentWorkshop\r\n  useEffect(() => {\r\n    if (isUndefined(workshopName) && activeStep > 1) {\r\n      setIncomplete({ ...incomplete, workshopDetails: true })\r\n    }\r\n    if (isUndefined(pinCode) && activeStep > 2) {\r\n      setIncomplete({ ...incomplete, location: true })\r\n    }\r\n    if (isUndefined(mobileNumber) && activeStep > 3) {\r\n      setIncomplete({ ...incomplete, contact: true })\r\n    }\r\n    if (isUndefined(paymentTerms) && activeStep != 4) {\r\n      setIncomplete({ ...incomplete, payment: true })\r\n    }\r\n  }, [currentWorkshop, activeStep])\r\n\r\n  const renderSteps = () => {\r\n    return stepperObject.map((step, index) =>\r\n      <Step\r\n        key={step.label}\r\n        label={<Label title={intl.formatMessage(step.label)} isComplete={workshopId} />}\r\n        onClick={() => setActiveStep(index + 1)}\r\n        completed={!isUndefined(currentWorkshop[step.isCompleted]) && currentWorkshop[step.isCompleted] !== \"\"}\r\n      />\r\n    )\r\n  }\r\n  const workshopEdit = async (update) => {\r\n    try {\r\n      await editWorkshop(auth, update, distributor._id, workshopid)\r\n      await getWorkshopDetails(distributor._id)\r\n      toast(intl.formatMessage(messages.workshopDetailsSaveSuccess))\r\n    } catch (error) {\r\n      toast(intl.formatMessage(messages.somethingWentWrong))\r\n    }\r\n  }\r\n  const handelFormSumbit = async (Data, stepNumber) => {\r\n    if (currentWorkshop._id)\r\n      workshopEdit(Data)\r\n    else\r\n      switch (stepNumber) {\r\n        case 1:\r\n        case 2:\r\n        case 3:\r\n          setCurrentWorkshop({ ...currentWorkshop, ...Data })\r\n          setActiveStep(stepNumber + 1)\r\n          break;\r\n        default:\r\n          setCurrentWorkshop({ ...currentWorkshop, ...Data })\r\n          try {\r\n            if (isUndefined(currentWorkshop.mobileNumber)) {\r\n              setActiveStep(3)\r\n            } else if (isUndefined(currentWorkshop.pinCode)) {\r\n              setActiveStep(2)\r\n            } else if (isUndefined(currentWorkshop.name)) {\r\n              setActiveStep(1)\r\n            } else {\r\n              await addWorkShop(auth, { ...currentWorkshop, ...Data },  distributor._id)\r\n              dispatcher(getWorkshops({auth, distributorId: distributor._id}))\r\n              history.push('/workshops')\r\n              if(localStorage.onboard){\r\n                localStorage.removeItem('onboard');\r\n                updateOnboard('')\r\n              }\r\n             \r\n              \r\n            }\r\n          } catch (error) {\r\n            if(error.response){\r\n              toast(error.response.data.errorMsg);\r\n            }else {\r\n              toast(intl.formatMessage(messages.somethingWentWrong));\r\n            }\r\n          }\r\n      }\r\n  }\r\n\r\n  return (\r\n    <>\r\n\r\n        <div className=\"mb-0 p-6 pb-0\">\r\n          <div className=\"text-center flex\" style={{ height: \"12.5%\" }}>\r\n            <div style={{ alignSelf: \"flex-end\", display: activeStep === 1 ? \"block\" : \"none\", marginLeft: \"auto\" }}>\r\n              <Button\r\n                variant=\"bulkAdd\"\r\n                size=\"md\"\r\n                onClick={() => history.push('/workshop/add/bulk')}\r\n              >\r\n                {intl.formatMessage(messages.bulkUpload)}\r\n              </Button>\r\n\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"w-full mb-0\">\r\n            <Stepper activeStep={activeStep} styleConfig={{\r\n              completedBgColor: \"#008000\",\r\n              activeBgColor: \"#1e293b\",\r\n            }}\r\n              style={{ paddingBottom: \"4px\" }}\r\n            >\r\n              {renderSteps()}\r\n            </Stepper>\r\n          </div>\r\n          <div className=\"flex-auto px-6 pb-6 pt-0\">\r\n            {activeStep === 1 && (\r\n              <WorkShopDetailsForm\r\n                currentWorkshop={currentWorkshop}\r\n                onFormSubmit={handelFormSumbit}\r\n              />\r\n            )}\r\n            {activeStep === 2 && (\r\n              <LocationDetailsForm\r\n                currentWorkshop={currentWorkshop}\r\n                onFormSubmit={handelFormSumbit}\r\n              />\r\n            )}\r\n            {activeStep === 3 && (\r\n              <WorkshopContactForm\r\n                currentWorkshop={currentWorkshop}\r\n                onFormSubmit={handelFormSumbit}\r\n              />\r\n            )}\r\n\r\n            {activeStep === 4 && (\r\n              <PaymentTermsForm\r\n                currentWorkshop={currentWorkshop}\r\n                onFormSubmit={handelFormSumbit}\r\n              />\r\n            )}\r\n          </div>\r\n        </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default WorkshopAddition;\r\n"]},"metadata":{},"sourceType":"module"}